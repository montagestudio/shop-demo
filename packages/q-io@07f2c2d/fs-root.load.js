montageDefine("07f2c2d","fs-root",{dependencies:["q","./fs-boot","./fs-common"],factory:function(e,t,n){function r(e,t){function n(n){var r;return r=e.isAbsolute(n)?e.relativeFromDirectory(e.ROOT,n):n,r=e.join(e.ROOT,r),r=e.relativeFromDirectory(e.ROOT,r),r=e.join(t,r),e.canonical(r).then(function(e){return e},function(){return r}).then(function(r){return e.contains(t,r)?{inner:e.join(e.ROOT,e.relativeFromDirectory(t,r)),outer:r}:i.reject("Can't find: "+JSON.stringify(n))})}function r(){return e.ROOT}var s=Object.create(o);return a.update(s,r),s.list=function(t){return n(t).then(function(t){return e.list(t.outer)}).then(null,function(){return i.reject("Can't list "+JSON.stringify(t))})},s.open=function(t,r,o){return n(t).then(function(t){return e.open(t.outer,r,o)}).then(null,function(){return i.reject("Can't open "+JSON.stringify(t))})},s.stat=function(t){return n(t).then(function(t){return e.stat(t.outer)}).then(null,function(){return i.reject("Can't stat "+JSON.stringify(t))})},s.statLink=function(t){return n(t).then(function(t){return e.statLink(t.outer)}).then(null,function(){return i.reject("Can't statLink "+JSON.stringify(t))})},s.canonical=function(e){return n(e).then(function(e){return e.inner}).then(null,function(){return i.reject("Can't find canonical of "+JSON.stringify(e))})},s.makeDirectory=function(t){return n(t).then(function(t){return e.makeDirectory(t.outer)}).catch(function(){throw Error("Can't make directory "+JSON.stringify(t))})},s.removeDirectory=function(t){return n(t).then(function(t){return e.removeDirectory(t.outer)}).catch(function(){throw Error("Can't remove directory "+JSON.stringify(t))})},s.remove=function(t){return n(t).then(function(t){return e.remove(t.outer)}).catch(function(){throw Error("Can't remove "+JSON.stringify(t))})},s.makeTree=function(t){return n(t).then(function(t){return e.makeTree(t.outer)}).catch(function(){throw Error("Can't make tree "+JSON.stringify(t))})},s.removeTree=function(t){return n(t).then(function(t){return e.removeTree(t.outer)}).catch(function(){throw Error("Can't remove tree "+JSON.stringify(t))})},i.when(e.canonical(t),function(e){return t=e,s})}var i=e("q"),o=e("./fs-boot"),a=e("./fs-common");n.exports=r}});