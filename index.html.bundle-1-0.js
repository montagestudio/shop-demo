montageDefine("aff95ef","ui/flow.reel/flow",{dependencies:["../component","frb/observers","./flow-bezier-spline","../../core/range-controller","../../core/deprecate"],factory:function(e,t){var n=e("../component").Component,r=e("frb/observers").observeProperty,i=e("./flow-bezier-spline").FlowBezierSpline,a=e("../../core/range-controller").RangeController,o=e("../../core/deprecate").deprecationWarning;t.Flow=n.specialize({constructor:{value:function(){this.super(),this._paths=[],this._visibleIndexes=[],this._needsClearVisibleIndexes=!0,this._slideOffsets={},this.defineBinding("_numberOfIterations",{"<-":"contentController.content.length"}),this.addOwnPropertyChangeListener("_numberOfIterations",this),window.addEventListener("resize",this,!1)}},slotContent:{serializable:!0,value:null},__flowTranslateComposer:{value:null},_flowTranslateComposer:{get:function(){return this.__flowTranslateComposer},set:function(e){this.__flowTranslateComposer&&(this.__flowTranslateComposer.removeEventListener("translateStart",this,!1),this.__flowTranslateComposer.removeEventListener("translateEnd",this,!1)),this.__flowTranslateComposer=e,this.__flowTranslateComposer.addEventListener("translateStart",this,!1),this.__flowTranslateComposer.addEventListener("translateEnd",this,!1)}},__firstIteration:{value:null},_firstIteration:{get:function(){return this.__firstIteration},set:function(e){this.__firstIteration=e,this.needsDraw=!0}},handleTranslateStart:{value:function(){this.callDelegateMethod("didTranslateStart",this)}},handleTranslateEnd:{value:function(){this.callDelegateMethod("didTranslateEnd",this)}},_scrollingMode:{value:"linear"},_transform:{value:null},_transformCss:{value:null},_transformPerspective:{value:null},scrollingMode:{serializable:!0,get:function(){return this._scrollingMode},set:function(e){switch(e){case"linear":case"drag":this._scrollingMode=e}}},_linearScrollingVector:{value:[-300,0]},linearScrollingVector:{seriazable:!0,get:function(){return this._linearScrollingVector},set:function(e){this._linearScrollingVector=e}},_repetition:{value:null},momentumDuration:{serializable:!0,value:650},_splinePaths:{value:null},splinePaths:{enumerable:!1,get:function(){return this._splinePaths||(this._splinePaths=[]),this._splinePaths},set:function(e){this._splinePaths=e}},_appendPath:{value:function(e){var t,n,r=new i,a=e.knots,o=e.knots.length,s=[],l=[],u=[],c=[];r.parameters={};for(t in e.units)r.parameters[t]={data:[],units:e.units[t]};for(t=0;o>t;t++){s[t]=a[t].knotPosition,u[t]=a[t].previousHandlerPosition,l[t]=a[t].nextHandlerPosition,c[t]=a[t].previousDensity;for(n in e.units)r.parameters[n].data.push(a[t][n])}r.knots=s,r.previousHandlers=u,r.nextHandlers=l,r.densities=c,r._computeDensitySummation(),this.splinePaths.push(r),e.hasOwnProperty("headOffset")||(e.headOffset=0),e.hasOwnProperty("tailOffset")||(e.tailOffset=0),this._paths.push(e),this._updateLength()}},_paths:{value:null},paths:{get:function(){var e,t,n,r,i,a,o,s=this.splinePaths.length,l=[];for(i=0;s>i;i++){for(t=this.splinePaths[i].knots.length,e={knots:[],units:{}},a=0;t>a;a++)r={knotPosition:this.splinePaths[i].knots[a]},this.splinePaths[i].nextHandlers&&this.splinePaths[i].nextHandlers[a]&&(r.nextHandlerPosition=this.splinePaths[i].nextHandlers[a]),this.splinePaths[i].previousHandlers&&this.splinePaths[i].previousHandlers[a]&&(r.previousHandlerPosition=this.splinePaths[i].previousHandlers[a]),this.splinePaths[i].densities&&this.splinePaths[i].densities[a]&&(r.previousDensity=this.splinePaths[i].densities[a],r.nextDensity=this.splinePaths[i].densities[a]),e.knots.push(r);for(a in this.splinePaths[i].parameters)for(e.units[a]=this.splinePaths[i].parameters[a].units,n=this.splinePaths[i].parameters[a].data.length,o=0;n>o;o++)e.knots[o][a]=this.splinePaths[i].parameters[a].data[o];e.headOffset=this._paths[i].hasOwnProperty("headOffset")?this._paths[i].headOffset:0,e.tailOffset=this._paths[i].hasOwnProperty("tailOffset")?this._paths[i].tailOffset:0,l.push(e)}return l},set:function(e){var t,n=e.length;for(this._splinePaths=[],this._paths=[],t=0;n>t;t++)this._appendPath(e[t]);this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_isCameraEnabled:{value:!0},isCameraEnabled:{get:function(){return this._isCameraEnabled},set:function(e){var t=!!e;this._isCameraEnabled!==t&&(this._isCameraEnabled=t,this._isCameraUpdated=!0,this._needsComputeVisibleRange=!0,this.needsDraw=!0)}},_perspective:{value:500},perspective:{get:function(){return this._perspective},set:function(e){var t=parseFloat(e);isNaN(t)||this._perspective===t||(this._perspective=t,this._isCameraUpdated=!0,this._needsComputeVisibleRange=!0,this.needsDraw=!0)}},_cameraElement:{value:null},_cameraPosition:{value:[0,0,800]},cameraPosition:{get:function(){return this._cameraPosition},set:function(e){this._cameraPosition=e,this._isCameraUpdated=!0,this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_viewpointPosition:{get:function(){return this._isCameraEnabled?this.cameraPosition:[.01*(50-this._sceneOffsetLeft)*this._width,.01*(50-this._sceneOffsetTop)*this._height,this._perspective]}},_cameraTargetPoint:{value:[0,0,0]},cameraTargetPoint:{get:function(){return this._cameraTargetPoint},set:function(e){this._cameraTargetPoint=e,this._isCameraUpdated=!0,this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_viewpointTargetPoint:{get:function(){return this._isCameraEnabled?this.cameraTargetPoint:[.01*(50-this._sceneOffsetLeft)*this._width,.01*(50-this._sceneOffsetTop)*this._height,0]}},_cameraFov:{value:50},cameraFov:{get:function(){return this._cameraFov},set:function(e){this._cameraFov=e,this._isCameraUpdated=!0,this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_viewpointFov:{get:function(){return this._isCameraEnabled?this.cameraFov:360*(Math.PI/2-Math.atan2(this._perspective,this._height/2))/Math.PI}},_cameraRoll:{value:0},cameraRoll:{get:function(){return this._cameraRoll},set:function(e){this._cameraRoll=e,this._isCameraUpdated=!0,this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_sceneOffsetTop:{value:50},sceneOffsetTop:{get:function(){return this._sceneOffsetTop},set:function(e){this._sceneOffsetTop=e,this._isCameraUpdated=!0,this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_sceneOffsetLeft:{value:50},sceneOffsetLeft:{get:function(){return this._sceneOffsetLeft},set:function(e){this._sceneOffsetLeft=e,this._isCameraUpdated=!0,this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_sceneScaleX:{value:{numerator:1,denominator:1}},_sceneScaleY:{value:{numerator:1,denominator:1}},_sceneScaleZ:{value:{numerator:1,denominator:1}},_sceneScale:{value:{x:{numerator:1,denominator:1},y:{numerator:1,denominator:1},z:{numerator:1,denominator:1}}},_updateSceneScale:{value:function(){this._sceneScale={x:this._sceneScaleX,y:this._sceneScaleY,z:this._sceneScaleZ}}},sceneScaleX:{get:function(){return this._sceneScaleX},set:function(e){"object"!=typeof e||void 0===e.numerator||void 0===e.denominator||isNaN(e.numerator)||isNaN(e.denominator)||0==e.denominator||(this._sceneScaleX=e,this._updateSceneScale(),this.needsDraw=!0,this._needsComputeVisibleRange=!0)}},sceneScaleY:{get:function(){return this._sceneScaleY},set:function(e){"object"!=typeof e||void 0===e.numerator||void 0===e.denominator||isNaN(e.numerator)||isNaN(e.denominator)||0==e.denominator||(this._sceneScaleY=e,this._updateSceneScale(),this.needsDraw=!0,this._needsComputeVisibleRange=!0)}},sceneScaleZ:{get:function(){return this._sceneScaleZ},set:function(e){"object"!=typeof e||void 0===e.numerator||void 0===e.denominator||isNaN(e.numerator)||isNaN(e.denominator)||0==e.denominator||(this._sceneScaleZ=e,this._updateSceneScale(),this.needsDraw=!0,this._needsComputeVisibleRange=!0)}},_stride:{value:0},stride:{get:function(){return this._stride},set:function(e){this._stride=e}},_scrollingTransitionDurationMiliseconds:{value:500},_scrollingTransitionDuration:{value:"500ms"},scrollingTransitionDuration:{get:function(){return this._scrollingTransitionDuration},set:function(e){var t,n,r=e+"";r.length,(n=/^(\d+)ms$/.exec(r))?t=+n[1]:(n=/^(\d+)s$/.exec(r))?t=1e3*+n[1]:(t=+r,r+="ms"),isNaN(t)||this._scrollingTransitionDurationMiliseconds===t||(this._scrollingTransitionDurationMiliseconds=t,this._scrollingTransitionDuration=r)}},hasSelectedIndexScrolling:{value:!1},selectedIndexScrollingOffset:{value:0},_handleSelectedIndexesChange:{value:function(e){this.hasSelectedIndexScrolling&&e[0]&&this.startScrollingIndexToOffset(Math.floor(this.contentController.content.indexOf(e[0].object)/this._paths.length),this.selectedIndexScrollingOffset)}},_timingFunctions:{value:{ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]}},_scrollingTransitionTimingFunctionBezier:{value:[.25,.1,.25,1]},_scrollingTransitionTimingFunction:{value:"ease"},scrollingTransitionTimingFunction:{get:function(){return this._scrollingTransitionTimingFunction},set:function(e){var t,n,r=e+"";if(this._timingFunctions.hasOwnProperty(r))this._scrollingTransitionTimingFunction=r,this._scrollingTransitionTimingFunctionBezier=this._timingFunctions[r];else if("cubic-bezier("===r.substr(0,13)&&")"===r.substr(r.length-1,1)&&(t=r.substr(13,r.length-14).split(","),4===t.length)){for(n=0;4>n;n++)if(t[n]-=0,isNaN(t[n]))return;0>t[0]?t[0]=0:t[0]>1&&(t[0]=1),0>t[2]?t[2]=0:t[2]>1&&(t[2]=1),this._scrollingTransitionTimingFunction="cubic-bezier("+t+")",this._scrollingTransitionTimingFunctionBezier=t}}},_computeCssCubicBezierValue:{value:function(e,t){var n,r,i,a=.5,o=.25;for(i=0;20>i;i++)n=a*a,r=1-a,3*(r*r*a*t[0]+r*n*t[2])+n*a>e?a-=o:a+=o,o*=.5;return n=a*a,r=1-a,3*(r*r*a*t[1]+r*n*t[3])+n*a}},_isTransitioningScroll:{value:!1},stopScrolling:{value:function(){this._isTransitioningScroll=!1}},startScrollingIndexToOffset:{value:function(e,t){this._scrollingOrigin=this.scroll,this._scrollingDestination=e-t,this._scrollingDestination>this._length?this._scrollingDestination=this._length:0>this._scrollingDestination&&(this._scrollingDestination=0),this._isScrolling=!0,this._scrollingStartTime=Date.now(),this._isTransitioningScroll=!0,this.needsDraw=!0,this.callDelegateMethod("didTranslateStart",this)}},_isCameraUpdated:{value:!0},_width:{value:0},_height:{value:0},_boundingBoxSize:{value:null},boundingBoxSize:{serializable:!0,get:function(){return this._boundingBoxSize},set:function(e){this._boundingBoxSize=e,this.elementsBoundingSphereRadius=.5*Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),this._needsComputeVisibleRange=!0}},_elementsBoundingSphereRadius:{value:1},elementsBoundingSphereRadius:{get:function(){return this._elementsBoundingSphereRadius},set:function(e){this._elementsBoundingSphereRadius!==e&&(this._elementsBoundingSphereRadius=e,this.needsDraw=!0,this._needsComputeVisibleRange=!0)}},_halfPI:{value:.5*Math.PI},_doublePI:{value:2*Math.PI},_computeFrustumNormals:{value:function(){var e,t,n,r,i,a,o,s,l,u=.5*this._viewpointFov*this._doublePI/360,c=Math.sin(u),h=Math.cos(u),d=c*this._width/this._height,p=this._viewpointPosition,f=this._viewpointTargetPoint,m=f[0]-p[0],v=f[1]-p[1],g=f[2]-p[2],_=this._halfPI-Math.atan2(g,m),b=m*Math.sin(_)+g*Math.cos(_),y=this._halfPI-Math.atan2(b,v),w=[[h,0,d],[-h,0,d],[0,h,c],[0,-h,c]],E=[];for(l=0;4>l;l++)s=w[l],e=s[0],t=s[1]*Math.cos(-y)-s[2]*Math.sin(-y),n=s[1]*Math.sin(-y)+s[2]*Math.cos(-y),r=e*Math.cos(-_)-n*Math.sin(-_),i=t,a=e*Math.sin(-_)+n*Math.cos(-_),o=1/Math.sqrt(r*r+i*i+a*a),E.push([r*o,i*o,a*o]);return E}},_segmentsIntersection:{value:function(e,t){for(var n,r,i=0,a=0,o=[];e.length>i&&t.length>a;)e[i][0]>=t[a][1]?a++:e[i][1]<=t[a][0]?i++:(n=e[i][0]>=t[a][0]?e[i][0]:t[a][0],r=e[i][1]<=t[a][1]?e[i][1]:t[a][1],o.push([n,r]),e[i][1]<t[a][1]?i++:e[i][1]>t[a][1]?a++:(i++,a++));return o}},_computeVisibleRange:{value:function(e){var t,n,r,i,a=e._knots.length-1,o=this._viewpointPosition,s=o[0],l=o[1],u=o[2],c=this._computeFrustumNormals(),h=[],d=[],p=[],f=this._elementsBoundingSphereRadius,m=e.getScaledKnots(this._sceneScale),v=e.getScaledNextHandlers(this._sceneScale),g=e.getScaledPreviousHandlers(this._sceneScale),_=[];for(r=0;a>r;r++)if(t=c[0],h=e.directedPlaneBezierIntersection(s-t[0]*f,l-t[1]*f,u-t[2]*f,c[0],m[r],v[r],g[r+1],m[r+1]),h.length&&(t=c[1],d=e.directedPlaneBezierIntersection(s-t[0]*f,l-t[1]*f,u-t[2]*f,c[1],m[r],v[r],g[r+1],m[r+1]),d.length&&(n=this._segmentsIntersection(h,d),n.length&&(t=c[2],h=e.directedPlaneBezierIntersection(s-t[0]*f,l-t[1]*f,u-t[2]*f,c[2],m[r],v[r],g[r+1],m[r+1]),n=this._segmentsIntersection(h,n),n.length))))for(t=c[3],h=e.directedPlaneBezierIntersection(s-t[0]*f,l-t[1]*f,u-t[2]*f,c[3],m[r],v[r],g[r+1],m[r+1]),n=this._segmentsIntersection(h,n),i=0;n.length>i;i++)p.push([r,n[i][0],n[i][1]]);var b,y,w,E,C,x,S,O=e._densities;for(r=0;p.length>r;r++)b=O[p[r][0]],y=O[p[r][0]+1],w=p[r][0]?e._densitySummation[p[r][0]-1]:0,E=p[r][1],C=p[r][2],x=.5*(y-b)*E*E+E*b+w,S=.5*(y-b)*C*C+C*b+w,_.push([x,S]);return _}},_determineCssPrefixedProperties:{value:function(){"webkitTransform"in this.element.style?(this._transform="webkitTransform",this._transformCss="-webkit-transform",this._transformPerspective="webkitPerspective"):"MozTransform"in this.element.style?(this._transform="MozTransform",this._transformCss="-moz-transform",this._transformPerspective="MozPerspective"):"msTransform"in this.element.style?(this._transform="msTransform",this._transformCss="-ms-transform",this._transformPerspective="msPerspective"):(this._transform="transform",this._transformPerspective="perspective")}},_isListeningToResize:{value:!0},isListeningToResize:{get:function(){return this._isListeningToResize},set:function(e){var t=!!e;this._isListeningToResize!==t&&(this._isListeningToResize=t,this._isListeningToResize?window.addEventListener("resize",this,!1):window.removeEventListener("resize",this,!1))}},_needsClearVisibleIndexes:{value:!1},handleResize:{value:function(){this._isCameraUpdated=!0,this._needsComputeVisibleRange=!0,this.needsDraw=!0,this._needsClearVisibleIndexes=!0}},enterDocument:{value:function(e){e&&(this._determineCssPrefixedProperties(),this._repetition.addRangeAtPathChangeListener("selectedIterations",this,"_handleSelectedIndexesChange"))}},_updateVisibleIndexes:{value:function(e,t){var n,r,i=this._visibleIndexes,a=i&&!isNaN(i.length)?i.length:0,o=[];for(this._needsClearVisibleIndexes&&(this._visibleIndexes.splice(e.length,1/0),this._needsClearVisibleIndexes=!1),r=0;a>r;r++)"number"==typeof t[i[r]]?e[t[i[r]]]=null:o.push(r);for(r=n=0;o.length>n&&e.length>r;r++)null!==e[r]&&(i.set(o[n],e[r]),n++);for(n=a;e.length>r;r++)null!==e[r]&&(i.set(n,e[r]),n++)}},_needsComputeVisibleRange:{value:!0},_previousVisibleRanges:{value:null},viewportWidth:{get:function(){return this._width},set:function(e){this._width!==e&&(this._width=e,this._needsComputeVisibleRange=!0)}},viewportHeight:{get:function(){return this._height},set:function(e){this._height!==e&&(this._height=e,this._needsComputeVisibleRange=!0)}},_firstIterationWidth:{value:1},_firstIterationHeight:{value:1},firstIterationWidth:{get:function(){return this._firstIterationWidth},set:function(e){e!==this._firstIterationWidth&&(this._firstIterationWidth=e,this._needsComputeVisibleRange=!0,this._needsClearVisibleIndexes=!0)}},firstIterationHeight:{get:function(){return this._firstIterationHeight},set:function(e){e!==this._firstIterationHeight&&(this._firstIterationHeight=e,this._needsComputeVisibleRange=!0,this._needsClearVisibleIndexes=!0)}},_firstIterationOffsetLeft:{value:0},_firstIterationOffsetTop:{value:0},willDraw:{value:function(e){var t,n,r,i,a,o,s,l,u,c,h,d=[],p={},f=this._paths,m=f.length,v=this.splinePaths;if(this.viewportWidth=this._element.clientWidth,this.viewportHeight=this._element.clientHeight,this.__firstIteration){var g=this.__firstIteration.firstElement.children[0];if(0!==g.offsetWidth&&0!==g.offsetHeight&&(this.firstIterationWidth=g.offsetWidth,this.firstIterationHeight=g.offsetHeight,this._firstIterationOffsetLeft=g.offsetLeft,this._firstIterationOffsetTop=g.offsetTop,!this._boundingBoxSize)){var _=Math.max(Math.abs(this._firstIterationWidth+this._firstIterationOffsetLeft),Math.abs(this._firstIterationOffsetLeft)),b=Math.max(Math.abs(this._firstIterationHeight+this._firstIterationOffsetTop),Math.abs(this._firstIterationOffsetTop));this._elementsBoundingSphereRadius=Math.sqrt(_*_+b*b)}}this._isTransitioningScroll&&(c=(Date.now()-this._scrollingStartTime)/this._scrollingTransitionDurationMiliseconds,h=this._computeCssCubicBezierValue(c,this._scrollingTransitionTimingFunctionBezier),1>c?this.scroll=this._scrollingOrigin+(this._scrollingDestination-this._scrollingOrigin)*h:(this.scroll=this._scrollingDestination,this._isTransitioningScroll=!1,this._needsToCallDidTranslateEndDelegate=!0));var y,w,E,C,x,c=e,u=6,S=this.lastDrawTime?.018*(c-this.lastDrawTime)*this._elasticScrollingSpeed:0,O=1-S/u,T=this._minSlideOffsetIndex,P=this._maxSlideOffsetIndex;if(this.lastDrawTime=c,this._hasElasticScrolling)for(i=0;u>i;i++){for(r=this._draggedSlideIndex-1;r>=T;r--)y=this._getSlideOffset(r),w=this._getSlideOffset(r+1),E=(y-w)*O+w,E>0&&(E=0),this._updateSlideOffset(r,E);for(r=this._draggedSlideIndex+1;P>=r;r++)y=this._getSlideOffset(r),w=this._getSlideOffset(r-1),E=(y-w)*O+w,0>E&&(E=0),this._updateSlideOffset(r,E)}if(v.length){for(s=this._numberOfIterations%m,l=(this._numberOfIterations-s)/m,this._needsComputeVisibleRange&&(this._previousVisibleRanges=[]),a=0;m>a;a++)for(u=l+(s>a?1:0),this._needsComputeVisibleRange?(t=this._computeVisibleRange(v[a]),this._previousVisibleRanges[a]=t,v[a]._computeDensitySummation()):t=this._previousVisibleRanges[a],o=this._scroll-f[a].headOffset,r=0;t.length>r;r++){for(x=u/2,i=x;x>=1;)n=(0|i)*m+a,C=(0|i)+this._getSlideOffset(n)-o,x/=2,C>=t[r][0]?i-=x:i+=x;i=0|i-1,0>i&&(i=0);do n=i*m+a,C=i+this._getSlideOffset(n)-o,C>=t[r][0]&&t[r][1]>=C&&void 0===p[n]&&(p[n]=d.length,d.push(n)),i++;while(t[r][1]>=C&&u>i)}this._needsComputeVisibleRange=!1}this._updateVisibleIndexes(d,p)}},draw:{value:function(){var e,t,n,r,i,a,o,s,l,u,c=this._repetition._drawnIterations.length,h=(this._paths.length,this._visibleIndexes,this._viewpointPosition),d=this._viewpointTargetPoint;if(this._isTransitioningScroll&&(this.needsDraw=!0),this._isCameraUpdated){if(this._isCameraEnabled){var p,f,m=.5*Math.tan((90-.5*this._viewpointFov)*this._doublePI/360)*this._height,v=d[0]-h[0],g=d[1]-h[1],_=d[2]-h[2],b=Math.atan2(-v,-_);p=v*-Math.sin(-b)+_*Math.cos(-b),f=Math.atan2(-g,-p),this._element.style[this._transformPerspective]=m+"px",this._cameraElement.style[this._transform]="translate3d(0,0,"+m+"px)rotateX("+f+"rad)rotateY("+-b+"rad)"+"translate3d("+-h[0]+"px,"+-h[1]+"px,"+-h[2]+"px)",this._element.classList.remove("camera-disabled")}else this._element.style[this._transformPerspective]=this._perspective+"px",this._cameraElement.style[this._transform]="translate3d("+(.5*this._width-h[0])+"px, "+(.5*this._height-h[1])+"px,0)",this._element.classList.add("camera-disabled");this._isCameraUpdated=!1}if(this.splinePaths.length)for(e=0;c>e;e++)u=this.offset(this._visibleIndexes[e]),a=u.pathIndex,t=u.slideTime,s=this._splinePaths[a]._convertSplineTimeToBezierIndexTime(t),n=this._repetition._drawnIterations[e],r=n.cachedFirstElement||n.firstElement,null!==s?((i=r.children[0])&&(r.classList.contains("selected")?i.classList.add("selected"):i.classList.remove("selected"),r.classList.contains("active")?i.classList.add("active"):i.classList.remove("active")),o=this._splinePaths[a].getPositionAtIndexTime(s,this._sceneScale),l=this._splinePaths[a].getRotationAtIndexTime(s),r.setAttribute("style",this._transformCss+":translate3d("+1e-5*(1e5*o[0]>>0)+"px,"+1e-5*(1e5*o[1]>>0)+"px,"+1e-5*(1e5*o[2]>>0)+"px)"+(l[2]?"rotateZ("+1e-5*(1e5*l[2]>>0)+"rad)":"")+(l[1]?"rotateY("+1e-5*(1e5*l[1]>>0)+"rad)":"")+(l[0]?"rotateX("+1e-5*(1e5*l[0]>>0)+"rad)":"")+";"+this._splinePaths[a].getStyleAtIndexTime(s))):r.setAttribute("style",this._transformCss+":scale3d(0,0,0);opacity:0");else for(e=0;c>e;e++)n=this._repetition._drawnIterations[e],r=n.cachedFirstElement||n.firstElement,r.setAttribute("style",this._transformCss+":scale3d(0,0,0);opacity:0");this._slideOffsetsLength&&(this.needsDraw=!0),this._needsToCallDidTranslateEndDelegate&&(this._needsToCallDidTranslateEndDelegate=!1,this.callDelegateMethod("didTranslateEnd",this))}},_updateLength:{value:function(){if(this._paths){var e,t,n,r,i,a,o=this._paths.length,s=0;if(o>0){for(i=this._numberOfIterations%o,r=(this._numberOfIterations-i)/o,a=0;o>a;a++)e=this._paths[a],t=r+(i>a?1:0),n=t-e.tailOffset+e.headOffset-1,n>s&&(s=n);this.length=s}this.needsDraw=!0}}},_numberOfIterations:{value:0},handle_numberOfIterationsChange:{value:function(){this._updateLength()}},content:{get:function(){return this.getPath("contentController.content")},set:function(e){this.contentController=(new a).initWithContent(e)}},contentController:{value:null},isSelectionEnabled:{value:null},selectedIndexes:{serializable:!1,value:null},activeIndexes:{serializable:!1,value:null},observeProperty:{value:function(e,t,n){return"currentIteration"!==e&&"objectAtCurrentIteration"!==e&&"contentAtCurrentIteration"!==e?r(this,e,t,n):(o(e,":iteration.object"),this._repetition?this._repetition.observeProperty(e,t,n):void 0)}},templateDidLoad:{value:function(){var e=this;this._repetition.willDraw=function(){e.needsDraw=!0}}},_length:{value:0},length:{get:function(){return this._length},set:function(e){this._length=0>e?0:e}},_scroll:{value:0},_elasticScrollingRange:{value:20},_hasElasticScrolling:{value:!1},hasElasticScrolling:{get:function(){return this._hasElasticScrolling},set:function(e){this._hasElasticScrolling=e?!0:!1}},_slideOffsets:{value:null},_slideOffsetsLength:{value:0},_maxSlideOffsetIndex:{value:-1},_minSlideOffsetIndex:{value:2e9},_updateSlideOffset:{value:function(e,t){var n=1e-4;e>=0&&(-n>t||t>n?(void 0===this._slideOffsets[e]&&(this._slideOffsetsLength++,this._minSlideOffsetIndex>e&&(this._minSlideOffsetIndex=e),e>this._maxSlideOffsetIndex&&(this._maxSlideOffsetIndex=e)),this._slideOffsets[e]=t):this._removeSlideOffset(e))}},_incrementSlideOffset:{value:function(e,t){this._updateSlideOffset(e,this._getSlideOffset(e)+t)}},_removeSlideOffset:{value:function(e){if(void 0!==this._slideOffsets[e]){var t,n,r;if(delete this._slideOffsets[e],this._slideOffsetsLength--,e===this._minSlideOffsetIndex)for(t=Object.keys(this._slideOffsets),this._minSlideOffsetIndex=2e9,n=0;t.length>n;n++)r=0|t[n],this._minSlideOffsetIndex>r&&(this._minSlideOffsetIndex=r);if(e===this._maxSlideOffsetIndex)for(void 0===t&&(t=Object.keys(this._slideOffsets)),this._maxSlideOffsetIndex=-1,n=0;t.length>n;n++)r=0|t[n],r>this._maxSlideOffsetIndex&&(this._maxSlideOffsetIndex=r)}}},_getSlideOffset:{value:function(e){return this._minSlideOffsetIndex>e?e=this._minSlideOffsetIndex>this._draggedSlideIndex?this._draggedSlideIndex:this._minSlideOffsetIndex:e>this._maxSlideOffsetIndex&&(e=this._maxSlideOffsetIndex<this._draggedSlideIndex?this._draggedSlideIndex:this._maxSlideOffsetIndex),void 0!==this._slideOffsets[e]?this._slideOffsets[e]:0}},scroll:{get:function(){return this._scroll},set:function(e){if(0>e&&(e=0),e>this.length&&(e=this.length),this._hasElasticScrolling&&null!==this._draggedSlideIndex){var t,n,r=this._draggedSlideIndex-this._elasticScrollingRange,i=this._draggedSlideIndex+this._elasticScrollingRange;for(r>this._minSlideOffsetIndex&&(r=this._minSlideOffsetIndex),this._maxSlideOffsetIndex>i&&(i=this._maxSlideOffsetIndex),n=e-this._scroll,0>r&&(r=0),t=r;i>=t;t++)t!==this._draggedSlideIndex?this._incrementSlideOffset(t,n):this._removeSlideOffset(t);this._scroll=e}else this._scroll=e;this.needsDraw=!0}},previousStride:{value:function(){var e=Math.round(this.scroll/this.stride),t=(e-1)*this.stride;this.startScrollingIndexToOffset(0,-t)}},nextStride:{value:function(){var e=Math.round(this.scroll/this.stride),t=(e+1)*this.stride;this.startScrollingIndexToOffset(0,-t)}},_isInputEnabled:{value:!0},isInputEnabled:{get:function(){return this._isInputEnabled},set:function(e){this._isInputEnabled=e?!0:!1}},_draggedSlideIndex:{value:0},draggedSlideIndex:{get:function(){return this._draggedSlideIndex},set:function(e){if(e!==this._draggedSlideIndex){if(null!==e){var t,n=this._getSlideOffset(e),r=this._minSlideOffsetIndex,i=this._maxSlideOffsetIndex;for(this._incrementSlideOffset(this._draggedSlideIndex,-n),t=r;i>=t;t++)t!==this._draggedSlideIndex&&this._incrementSlideOffset(t,-n);this._removeSlideOffset(e),this._scroll-=n,this._flowTranslateComposer._scroll=this._scroll}this._draggedSlideIndex=e,this.needsDraw=!0}}},_elasticScrollingSpeed:{value:1},elasticScrollingSpeed:{get:function(){return this._elasticScrollingSpeed},set:function(e){this._elasticScrollingSpeed=parseFloat(e)}},lastDrawTime:{value:null},offset:{enumerable:!1,value:function(e){var t=this._paths.length,n=e%t,r=Math.floor(e/t)-this._scroll+this._paths[n].headOffset;return{pathIndex:n,slideTime:r+this._getSlideOffset(e)}}},serializeSelf:{value:function(e){e.setAllProperties();for(var t,n=this.originalContent,r=0;t=n[r];r++)t.component&&e.addObject(t.component)}}})}}),montageDefine("aff95ef","ui/repetition.reel/repetition",{dependencies:["../../core/core","../component","../../core/template","../../core/range-controller","../../core/promise","../../core/browser","../../composer/press-composer","collections/map","collections/set","../../core/deprecate","../../core/logger","frb/observers"],factory:function(e,t){var n=e("../../core/core").Montage,r=e("../component").Component;e("../../core/template").Template;var i=e("../../core/range-controller").RangeController,a=e("../../core/promise").Promise;e("../../core/browser").browser;var o=e("../../composer/press-composer").PressComposer,s=e("collections/map"),l=e("collections/set"),u=e("../../core/deprecate").deprecationWarning,c=e("../../core/logger").logger("repetition").color.magenta(),h=e("frb/observers"),d=h.observeProperty,p=h.observeKey,f=60,m=t.Iteration=n.specialize({repetition:{value:null},controller:{value:null},_object:{value:null},object:{get:function(){return this._object},set:function(e){var t;this._object!==e&&(this._object=e,t=-1!==this.repetition.contentController.selection.indexOf(e),this._selected!==t&&(this.selected=t))}},_fragment:{value:null},_childComponents:{value:null},index:{value:null},_drawnIndex:{value:null},active:{value:null},_noTransition:{value:null},_templateDocumentPart:{value:null},isDirty:{value:!1},_selected:{value:null},selected:{get:function(){return this._selected},set:function(e){e=!!e,this.object&&this.repetition&&this.repetition.contentController&&(e?this.repetition.contentController.selection.add(this.object):this.repetition.contentController.selection.delete(this.object)),this._selected!==e&&(this._selected=e,this.repetition._addDirtyClassListIteration(this),this.repetition.needsDraw=!0)}},constructor:{value:function m(){this.super(),c.isDebug&&c.debug("Iteration:%s create iteration %O",Object.hash(this),this),this.repetition=null,this.controller=null,this.object=null,this._fragment=null,this._childComponents=null,this.index=null,this._drawnIndex=null,this.active=!1,this.defineBinding("active",{"<->":"repetition.activeIterations.has(())"}),this._noTransition=!1,this.addOwnPropertyChangeListener("active",this),this.addOwnPropertyChangeListener("_noTransition",this),this.addPathChangeListener("index.defined() && _childComponents.defined()",this,"handleComponentModelChange"),this.cachedFirstElement=null}},_timeoutBecomeActiveID:{value:null},_shouldBecomeActive:{value:!1},shouldBecomeActive:{set:function(e){if(this._timeoutBecomeActiveID&&(clearTimeout(this._timeoutBecomeActiveID),this._timeoutBecomeActiveID=null),e){var t=this;this._shouldBecomeActive=!0,this._timeoutBecomeActiveID=setTimeout(function(){t._shouldBecomeActive&&(t.active=!0),t._shouldBecomeActive=!1},f)}else this._shouldBecomeActive=!1},get:function(){return this._shouldBecomeActive}},initWithRepetition:{value:function(e){return this.repetition=e,this}},recycle:{value:function(){this.index=null,this.object=null,this._noTransition=!0}},injectIntoDocument:{value:function(e){null!==this._drawnIndex?(c.isDebug&&c.debug("Iteration:%s retracting from index %s and injecting at %s",Object.hash(this),this._drawnIndex,e),this.retractFromDocument()):c.isDebug&&c.debug("Iteration:%s injecting at index %s",Object.hash(this),e);var t=this,n=this.repetition,r=n.element,i=n._boundaries,a=r.ownerDocument.createTextNode(""),o=i[e];if(i.splice(e,0,a),r.insertBefore(a,o),r.insertBefore(this._fragment,o),n._drawnIterations.splice(e,0,this),n._updateDrawnIndexes(e),n._addDirtyClassListIteration(this),!this._elementsWillBeAddedToMap){var s=this._childComponents.length,l=function(e){e.target.removeEventListener("firstDraw",l,!1),s--,s||t.forEachElement(function(e){n._iterationForElement.set(e,t)})};if(this._childComponents.length>0)for(var u=0;this._childComponents.length>u;u++){var h=this._childComponents[u];h.addEventListener("firstDraw",l,!1),h.needsDraw=!0,h._completedFirstDraw===!0&&console.error("Repetiton:%s child component %O has already drawn.",Object.hash(this),h)}else this.forEachElement(function(e){n._iterationForElement.set(e,t)});this._elementsWillBeAddedToMap=!0}}},_elementsWillBeAddedToMap:{value:!1},retractFromDocument:{value:function(){c.isDebug&&c.debug("Iteration:%s retractFromDocument drawnIndex: %s",Object.hash(this),this._drawnIndex);var e=this._drawnIndex,t=this.repetition,n=t.element,r=t._boundaries[e],i=t._boundaries[e+1];t._boundaries.splice(e,1);for(var a=this._fragment,o=r.nextSibling;o!=i;){var s=o.nextSibling;n.removeChild(o),a.appendChild(o),o=s}n.removeChild(r),this._drawnIndex=null,t._drawnIterations.splice(e,1),t._updateDrawnIndexes(e)}},handleComponentModelChange:{value:function(e){e?this._childComponents.forEach(this.repetition.addChildComponent,this.repetition):this._childComponents&&this._childComponents.forEach(this.repetition.removeChildComponent,this.repetition)}},handlePropertyChange:{value:function(){this.repetition&&(this.repetition._addDirtyClassListIteration(this),this.repetition.needsDraw=!0)}},forEachElement:{value:function(e,t){var n=this.repetition,r=this._drawnIndex;if(null!=r)for(var i=n._boundaries[r];i!==n._boundaries[r+1];i=i.nextSibling)1===i.nodeType&&e.call(t,i)}},firstElement:{get:function(){var e=this.repetition,t=this._drawnIndex;if(null!=t)for(var n=e._boundaries[t];n!==e._boundaries[t+1];n=n.nextSibling)if(1===n.nodeType)return this.cachedFirstElement=n,n}},isComponentTreeLoaded:{value:function(){return null!==this._fragment}},cachedFirstElement:{value:null}});t.Repetition=r.specialize({initWithContent:{value:function(e){return this.object=e,this}},initWithContentController:{value:function(e){return this.contentController=e,this}},content:{get:function(){return this.contentController?this.contentController.content:null},set:function(e){this.contentController=(new i).initWithContent(e)}},contentController:{value:null},isSelectionEnabled:{value:null},selectedIterations:{value:null},selectedIndexes:{value:null},activeIterations:{value:null},iterations:{value:null},currentIteration:{value:null},objectAtCurrentIteration:{value:null},hasTemplate:{value:!1},_iterationTemplate:{value:null},clonesChildComponents:{value:!0},__pressComposer:{value:null},_pressComposer:{get:function(){return this.__pressComposer||(this.__pressComposer=new o,this.__pressComposer.lazyLoad=!0,this.addComposerForElement(this.__pressComposer,this.element)),this.__pressComposer}},_cancelSelectionRangeChangeListener:{value:null},_selection:{value:null},selection:{get:function(){return this._selection},set:function(e){this.contentController?(this.contentController.selection!==e&&(this.contentController.selection=e),this._selection!==this.contentController.selection&&(this._selection=this.contentController.selection),this._cancelSelectionRangeChangeListener&&this._cancelSelectionRangeChangeListener(),e?(this._cancelSelectionRangeChangeListener=this.contentController.selection.addRangeChangeListener(this,"selection"),this.handleSelectionRangeChange(e,[])):this._cancelSelectionRangeChangeListener=null):this._selection=e
}},handleSelectionRangeChange:{value:function(e,t){var n,r,i,a,o,l,u=this.iterations.length;if(1>=e.length&&1>=t.length){if(t.length)for(i=t[0],o=0;u>o;o++)this.iterations[o].object===i&&(this.iterations[o].selected=!1);if(e.length)for(i=e[0],o=0;u>o;o++)this.iterations[o].object===i&&(this.iterations[o].selected=!0)}else{for(n=new s,o=0;u>o;o++)a=this.iterations[o],i=a.object,(r=n.get(i))||(r=[],n.set(i,r)),r.push(a);for(o=0;t.length>o;o++)if(r=n.get(t[o]))for(l=0;r.length>l;l++)r[l].selected=!1;for(o=0;e.length>o;o++)if(r=n.get(e[o]))for(l=0;r.length>l;l++)r[l].selected=!0}}},_visibleIndexes:{value:null},visibleIndexes:{get:function(){return this._visibleIndexes},set:function(e){this._visibleIndexes!==e&&(this._visibleIndexes&&this._visibleIndexes.removeRangeChangeListener&&this._visibleIndexes.removeRangeChangeListener(this,"visibleIndexes"),this._visibleIndexes=e,this._visibleIndexes&&this._visibleIndexes.addRangeChangeListener&&this._visibleIndexes.addRangeChangeListener(this,"visibleIndexes"),this._updateOrganizedContent())}},handleVisibleIndexesRangeChange:{value:function(e,t,n){var r,i;if(this.__controllerOrganizedContent){for(r=[],i=0;e.length>i;i++)r.push(this.__controllerOrganizedContent[e[i]]);this.organizedContent.swap(n,t.length,r),this._isListeningToOrganizedContentChanges&&(this.handleOrganizedContentRangeChange(r.length,t.length,n),this.needsDraw=!0)}}},__controllerOrganizedContent:{value:null},_controllerOrganizedContent:{get:function(){return this.__controllerOrganizedContent},set:function(e){this.__controllerOrganizedContent!==e&&(this.__controllerOrganizedContent&&this.__controllerOrganizedContent.removeRangeChangeListener&&this.__controllerOrganizedContent.removeRangeChangeListener(this,"controllerOrganizedContent"),this.__controllerOrganizedContent=e,this.__controllerOrganizedContent&&this.__controllerOrganizedContent.addRangeChangeListener&&this.__controllerOrganizedContent.addRangeChangeListener(this,"controllerOrganizedContent"),this._updateOrganizedContent())}},handleControllerOrganizedContentRangeChange:{value:function(e,t,n){this._visibleIndexes?this._updateOrganizedContent():(this.organizedContent.swap(n,t.length,e),this._isListeningToOrganizedContentChanges&&(this.handleOrganizedContentRangeChange(e.length,t.length,n),this.needsDraw=!0))}},_updateOrganizedContent:{value:function(){var e,t;if(this.__controllerOrganizedContent)if(this._visibleIndexes){for(this.organizedContent.length>this._visibleIndexes.length&&(this.organizedContent.length=this._visibleIndexes.length,this._isListeningToOrganizedContentChanges&&this.handleOrganizedContentRangeChange(0,this.organizedContent.length-this._visibleIndexes.length,this._visibleIndexes.length)),e=this.organizedContent.length,t=0;this._visibleIndexes.length>t;t++)this.organizedContent[t]!==this.__controllerOrganizedContent[this._visibleIndexes[t]]&&(this.organizedContent[t]=this.__controllerOrganizedContent[this._visibleIndexes[t]],this._isListeningToOrganizedContentChanges&&this.handleOrganizedContentRangeChange(1,e>t?1:0,t));this._isListeningToOrganizedContentChanges&&(this.needsDraw=!0)}else e=this.organizedContent.length,this.organizedContent.swap(0,e,this.__controllerOrganizedContent),this._isListeningToOrganizedContentChanges&&(this.handleOrganizedContentRangeChange(this.__controllerOrganizedContent.length,e,0),this.needsDraw=!0);else e=this.organizedContent.length,this.organizedContent=[],this._isListeningToOrganizedContentChanges&&(this.handleOrganizedContentRangeChange(0,e,0),this.needsDraw=!0)}},constructor:{value:function(){this.super(),this.contentController=null,this.organizedContent=[],this.defineBinding("_controllerOrganizedContent",{"<-":"contentController.organizedContent"}),this.isSelectionEnabled=!1,this.defineBinding("selection",{"<-":"contentController.selection"}),this.defineBinding("selectedIterations",{"<-":"iterations.filter{selected}"}),this.defineBinding("selectedIndexes",{"<-":"selectedIterations.map{index}"}),this._iterationTemplate=null,this.addPathChangeListener(this._setupRequirements,this,"_handleSetupRequirementsChange"),this.addPathChangeListener("innerTemplate",this,"_handleInnerTemplateChange"),this.iterations=[],this._drawnIterations=[],this._freeIterations=[],this._contentForIteration=s(),this._iterationForElement=s(),this.currentIteration=null,this._templateId=null,this._iterationCreationPromise=a.resolve(),this._boundaries=[],this._dirtyClassListIterations=l(),this._requestedIterations=0,this._createdIterations=0,this._canDrawInitialContent=!1,this._initialContentDrawn=!1,this.addOwnPropertyChangeListener("isSelectionEnabled",this),this._selectionPointer=null,this.activeIterations=[]}},_setupRequirements:{value:"[!_iterationTemplate.defined(),!_newDomContent.defined(),!_shouldClearDomContentOnNextDraw,_isComponentExpanded,_ownerDocumentPart.defined()].every{}"},_handleSetupRequirementsChange:{value:function(e){e&&this._setupIterationTemplate()}},_handleInnerTemplateChange:{value:function(e){this._iterationTemplate&&this._teardownIterationTemplate(),e&&this.getPath(this._setupRequirements)&&this._setupIterationTemplate()}},cleanupDeletedComponentTree:{value:function(e){var t=this._innerTemplate;this._innerTemplate=null,t&&this._teardownIterationTemplate(),e&&this.cancelBindings()}},expandComponent:{value:function(){return this._isComponentExpanded=!0,a.resolve()}},_buildIterationTemplate:{value:function(){var e,t,r,i;return e=this.innerTemplate.clone(),t=e.getSerialization(),r=t.getSerializationObject(),i=n.getInfoForObject(this).label,this._iterationLabel=i+":iteration",r[this._iterationLabel]={},e.setObjects(r),this.innerTemplate.hasParameters()&&this._expandIterationTemplateParameters(e),window._montage_le_flag&&(e.refresher=this,this._leTagIterationTemplate(e)),e}},_rebuildIterationTemplate:{value:function(){var e,t=this._iterationTemplate,n=this.iterations;this._purgeFreeIterations();for(var r,i=0;r=n[i];i++)r.isDirty=!0;this._innerTemplate=null,e=this._buildIterationTemplate(),t.replaceContentsWithTemplate(e)}},refreshTemplate:{value:function(){this._rebuildIterationTemplate()}},_isListeningToOrganizedContentChanges:{value:!1},_setupIterationTemplate:{value:function(){this._iterationTemplate=this._buildIterationTemplate();for(var e,t=this.childComponents,n=t.length-1;e=t[n--];)e.detachFromParentComponent(),e.needsDraw=!1,e.cleanupDeletedComponentTree(!0);this.handleOrganizedContentRangeChange(this.organizedContent.length,0,0),this._isListeningToOrganizedContentChanges=!0,this._canDrawInitialContent=!0,this.needsDraw=!0}},_leTagIterationTemplate:{value:function(e){var t=e.document.body;if(t.children.length>0){var n=this.ownerComponent._montage_metadata.moduleId,r=this._montage_metadata.label;this._leTagStarArgument(n,r,t)}}},_teardownIterationTemplate:{value:function(){this._isListeningToOrganizedContentChanges=!1,this.handleOrganizedContentRangeChange(0,this.organizedContent.length,0),this._purgeFreeIterations(),this._iterationTemplate=null,this._contentForIteration.clear(),this._iterationForElement.clear(),this.currentIteration=null,this._templateId=null,this._requestedIterations=0,this._createdIterations=0,this._canDrawInitialContent=!1,this._selectionPointer=null,this.activeIterations.clear(),this._dirtyClassListIterations.clear()}},_purgeFreeIterations:{value:function(){for(var e=0;this._freeIterations.length>e;e++)for(var t=this._freeIterations[e],n=0;t._childComponents.length>n;n++){var r=t._childComponents[n];this.removeChildComponent(r),r.cleanupDeletedComponentTree(!0)}this._freeIterations.clear()}},_expandIterationTemplateParameters:{value:function(e){for(var t,n,r,i,a,o,s,l,u,c=this;e.hasParameters();){c=c.ownerComponent,t=c._ownerDocumentPart.template,i=c._ownerDocumentPart.objects,o=e.expandParameters(c),r=e.getSerialization().getExternalObjectLabels(),a=e.getInstances(),l=o.labels,n=o.labelsCollisions;for(var h,d=0;h=l[d];d++)s=n&&h in n?n[h]:h,r.indexOf(s)>=0?a[s]=i[h]:(u=t.getObjectMetadata(h),u.owner||(u.owner=i.owner),e.setObjectMetadata(s,u.require,u.label,u.owner))}}},_iterationLabel:{value:null},_iterationCreationPromise:{value:null},_createIteration:{value:function(){var e=this,t=(new this.Iteration).initWithRepetition(this);return this._iterationCreationPromise=this._iterationCreationPromise.then(function(){var n,r,i=e.element.ownerDocument;return e.currentIteration=t,n=e._iterationTemplate.getInstances(),n=Object.create(n),n[e._iterationLabel]=t,r=e._iterationTemplate.instantiateWithInstances(n,i).then(function(n){n.parentDocumentPart=e._ownerDocumentPart,t._templateDocumentPart=n,n.loadComponentTree().then(function(){c.isDebug&&c.debug("Iteration:%s component tree loaded.",Object.hash(t)),t._fragment=n.fragment,t._childComponents=n.childComponents,e.constructIteration(t)}).done(),e.currentIteration=null}),r.done(),r.then(null,function(){})}),this._requestedIterations++,t}},constructIteration:{value:function(){this._createdIterations++,this._createdIterations>=this._requestedIterations&&(this.needsDraw=!0,this._canDraw=!0)}},observeProperty:{value:function(e,t,n){return"contentAtCurrentIteration"===e||"objectAtCurrentIteration"===e?("contentAtCurrentIteration"===e?u("contentAtCurrentIteration",":iteration.object"):"objectAtCurrentIteration"===e&&u("objectAtCurrentIteration",":iteration.object"),p(this._contentForIteration,this.currentIteration,t,n)):"currentIteration"===e?(u("currentIteration",":iteration"),t(this.currentIteration)):d(this,e,t,n)}},makePropertyObservable:{value:function(e){return"currentIteration"!==e?n.makePropertyObservable.call(this,e):void 0}},_controllerIterations:{value:null},_drawnIterations:{value:null},_freeIterations:{value:null},_contentForIteration:{value:null},handleOrganizedContentRangeChange:{value:function(e,t,n){var r,i,a,o,s=n,l=this.iterations,u=this._contentForIteration,h=Math.min(e,t),d=t-h,p=e-h,f=this.organizedContent;for(c.isDebug&&(c.debug("Repetition:%s content changed +%s@%s %O -%s %O ",Object.hash(this),e?e:0,n,t?t:0),c.debug("Repetition:%s +%s -%s iterations",Object.hash(this),p,d)),this._iterationTemplate.isDirty&&this._iterationTemplate.refresh(),a=0;h>a;a++,n++)l[n].object=f[n],u.set(l[n],f[n]);if(d>0)for(r=l.splice(n,d),a=0;d>a;a++)i=r[a],i.recycle(),i.isDirty||this._freeIterations.push(i);if(p>0){if(c.isDebug)var m=[];for(;p>this._freeIterations.length;)this._freeIterations.push(this._createIteration()),c.isDebug&&m.push(this._freeIterations[this._freeIterations.length-1]);var v=Array(p);for(a=h,o=0;e>a;a++,o++){var g=this._freeIterations.pop();c.isDebug&&(m.has(g)||c.debug("Repetition:%s reusing %s",Object.hash(this),Object.hash(g)));var _=f[s+a];g.object=_,u.set(g,_),v[o]=g}l.swap(n,0,v)}(d>0||p>0)&&this._updateIndexes(n)}},_updateIndexes:{value:function(e){for(var t=this.iterations;t.length>e;e++)t[e].index=e}},_addDirtyClassListIteration:{value:function(e){e.forEachElement(function(t){var n;t&&(n=t.component)?(n.classList[e.active?"add":"remove"]("active"),n.classList[e.selected?"add":"remove"]("selected"),n.classList.remove("no-transition")):this._dirtyClassListIterations.add(e)},this)}},canDraw:{value:function(){var e=this.canDrawGate.value;return e=e&&this._requestedIterations<=this._createdIterations,e=e&&(this._initialContentDrawn||this._canDrawInitialContent)}},_boundaries:{value:null},_dirtyClassListIterations:{value:null},_requestedIterations:{value:null},_createdIterations:{value:null},_canDrawInitialContent:{value:null},_initialContentDrawn:{value:null},draw:{value:function(){this._initialContentDrawn||(this._drawInitialContent(),this._initialContentDrawn=!0);for(var e=this._drawnIterations.length-1;e>=0;e--)null===this._drawnIterations[e].index&&this._drawnIterations[e].retractFromDocument();for(var e=0;this.iterations.length>e;e++){var t=this.iterations[e];t._drawnIndex!==t.index&&t.isComponentTreeLoaded()&&t.injectIntoDocument(e)}var n=this._dirtyClassListIterations.toArray();this._dirtyClassListIterations.clear(),n.forEach(function(e){e.isComponentTreeLoaded()&&e.forEachElement(function(t){t.component||(t.classList[e.active?"add":"remove"]("active"),t.classList[e.selected?"add":"remove"]("selected"),t.classList.remove("no-transition"))},this)},this)}},_drawInitialContent:{value:function(){for(var e=this.element,t=e.childNodes.length,n=0;t>n;n++)e.removeChild(e.firstChild);var r=e.ownerDocument.createTextNode("");e.appendChild(r),this._boundaries.push(r)}},_updateDrawnIndexes:{value:function(e){for(var t=this._drawnIterations;t.length>e;e++)t[e]._drawnIndex=e}},_selectionPointer:{value:null},_startX:{value:0},_startY:{value:0},_currentActiveIteration:{value:null},handleIsSelectionEnabledChange:{value:function(e){e?this._enableSelectionTracking():this._disableSelectionTracking()}},_enableSelectionTracking:{value:function(){this._pressComposer.addEventListener("pressStart",this,!1)}},_disableSelectionTracking:{value:function(){this._pressComposer.removeEventListener("pressStart",this,!1)}},handlePressStart:{value:function(e){var t=this._findIterationContainingElement(e.targetElement);t&&(this._startX=e.clientX,this._startY=e.clientY,this.__pressComposer.addEventListener("press",this,!1),this.__pressComposer.addEventListener("pressCancel",this,!1),t.shouldBecomeActive=!0,this._currentActiveIteration=t)}},_ignoreSelection:{value:function(){this._currentActiveIteration&&(this._currentActiveIteration.shouldBecomeActive=!1,this._currentActiveIteration=null),this.activeIterations.clear(),this._startX=0,this._startY=0,this.__pressComposer.removeEventListener("press",this,!1),this.__pressComposer.removeEventListener("pressCancel",this,!1)}},handlePressCancel:{value:function(){this._ignoreSelection()}},handlePress:{value:function(e){var t=this._findIterationContainingElement(e.targetElement);t&&this._currentActiveIteration===t&&(t.active=!1,t.selected||(t.selected=!0)),this._ignoreSelection()}},_findIterationContainingElement:{value:function(e){for(var t;e;){if(e===this.element)return this._iterationForElement.get(t);t=e,e=e.parentNode}}},Iteration:{value:m,serializable:!1}})}}),montageDefine("aff95ef","composer/translate-composer",{dependencies:["./composer","../core/event/event-manager"],factory:function(e,t){var n=e("./composer").Composer,r=e("../core/event/event-manager").defaultEventManager,i=t.TranslateComposer=n.specialize({constructor:{value:function i(){this.super()}},_NATIVE_ELEMENTS:{value:["A","IFRAME","EMBED","OBJECT","VIDEO","AUDIO","CANVAS","LABEL","INPUT","BUTTON","SELECT","TEXTAREA","KEYGEN","DETAILS","COMMAND"]},_WHEEL_POINTER:{value:"wheel",writable:!1},enabled:{value:!0},_externalUpdate:{value:!0},isAnimating:{value:!1},isMoving:{value:!1},frame:{value:function(){this.isAnimating&&this._animationInterval(),this._externalUpdate=!1}},_pointerSpeedMultiplier:{value:1},pointerSpeedMultiplier:{get:function(){return this._pointerSpeedMultiplier},set:function(e){this._pointerSpeedMultiplier=e}},pointerStartEventPosition:{value:null},_shouldDispatchTranslate:{value:!1},_isSelfUpdate:{value:!1},_allowFloats:{value:!1},allowFloats:{get:function(){return this._allowFloats},set:function(e){this._allowFloats!==e&&(this._allowFloats=e,this.translateX=this._translateX,this.translateY=this._translateY)}},allowTranslateOuterExtreme:{value:!1},_translateX:{value:0},translateX:{get:function(){return this._translateX},set:function(e){if("vertical"===this._axis)this._translateX=this._minTranslateX||0;else{var t=isNaN(e)?0:this._allowFloats?parseFloat(e):e>>0;null!==this._minTranslateX&&this._minTranslateX>t&&(t=this._minTranslateX),null!==this._maxTranslateX&&t>this._maxTranslateX&&(t=this._maxTranslateX),this._isSelfUpdate||(this.isAnimating=!1),this._translateX=t}}},_translateY:{value:0},translateY:{get:function(){return this._translateY},set:function(e){if("horizontal"===this._axis)this._translateY=this._minTranslateY||0;else{var t=isNaN(e)?0:this._allowFloats?parseFloat(e):e>>0;null!==this._minTranslateY&&this._minTranslateY>t&&(t=this._minTranslateY),null!==this._maxTranslateY&&t>this._maxTranslateY&&(t=this._maxTranslateY),this._isSelfUpdate||(this.isAnimating=!1),this._translateY=t}}},_minTranslateX:{value:null},minTranslateX:{get:function(){return this._minTranslateX},set:function(e){null!==e&&(e=parseFloat(e)),this._minTranslateX!==e&&(null!==e&&e>this._translateX&&(this.translateX=e),this._minTranslateX=e)}},_maxTranslateX:{value:null},maxTranslateX:{get:function(){return this._maxTranslateX},set:function(e){null!==e&&(e=parseFloat(e)),this._maxTranslateX!==e&&(null!==e&&this._translateX>e&&(this.translateX=e),this._maxTranslateX=e)}},_minTranslateY:{value:null},minTranslateY:{get:function(){return this._minTranslateY},set:function(e){null!==e&&(e=parseFloat(e)),this._minTranslateY!==e&&(null!==e&&e>this._translateY&&(this.translateY=e),this._minTranslateY=e)}},_maxTranslateY:{value:null},maxTranslateY:{get:function(){return this._maxTranslateY},set:function(e){null!==e&&(e=parseFloat(e)),this._maxTranslateY!==e&&(null!==e&&this._translateY>e&&(this.translateY=e),this._maxTranslateY=e)}},_axis:{value:"both"},axis:{get:function(){return this._axis},set:function(e){switch(e){case"vertical":case"horizontal":this._axis=e,this.translateX=this._translateX,this.translateY=this._translateY;break;default:this._axis="both"}}},invertAxis:{depends:["invertXAxis","invertYAxis"],get:function(){return this._invertXAxis===this._invertYAxis?this._invertXAxis:null},set:function(e){this.invertXAxis=e,this.invertYAxis=e}},_invertXAxis:{value:!1},invertXAxis:{get:function(){return this._invertXAxis},set:function(e){this._invertXAxis=!!e}},_invertYAxis:{value:!1},invertYAxis:{get:function(){return this._invertYAxis},set:function(e){this._invertYAxis=!!e}},_hasMomentum:{value:!0},hasMomentum:{get:function(){return this._hasMomentum},set:function(e){this._hasMomentum=e?!0:!1}},__momentumDuration:{value:650},_momentumDuration:{get:function(){return this.__momentumDuration},set:function(e){this.__momentumDuration=isNaN(e)?1:e>>0,1>this.__momentumDuration&&(this.__momentumDuration=1)}},_pointerX:{value:null},_pointerY:{value:null},_touchIdentifier:{value:null},_isFirstMove:{value:!1},_observedPointer:{value:null},eventManager:{get:function(){return r}},_mouseRadiusThreshold:{value:5},_touchRadiusThreshold:{value:12},_listenToWheelEvent:{value:!1},listenToWheelEvent:{set:function(e){e=!!e,this._listenToWheelEvent!==e&&(this._listenToWheelEvent=e,this._isLoaded&&(e?this._addWheelEventListener():this._removeWheelEventListener()))},get:function(){return this._listenToWheelEvent}},_claimPointerPolicy:{value:null},claimPointerPolicy:{set:function(e){(e===i.CLAIM_POINTER_POLICIES.DEFAULT||e===i.CLAIM_POINTER_POLICIES.MOVE)&&(this._claimPointerPolicy=e)},get:function(){return this._claimPointerPolicy||(this._claimPointerPolicy=i.CLAIM_POINTER_POLICIES.DEFAULT),this._claimPointerPolicy}},load:{value:function(){window.PointerEvent?this._element.addEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.addEventListener("MSPointerDown",this,!0):(this._element.addEventListener("touchstart",this,!0),this._element.addEventListener("mousedown",this,!0)),this._listenToWheelEvent&&this._addWheelEventListener(),this.eventManager.isStoringPointerEvents=!0}},unload:{value:function(){window.PointerEvent?this._element.removeEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.removeEventListener("MSPointerDown",this,!0):(this._element.removeEventListener("touchstart",this,!0),this._element.removeEventListener("mousedown",this,!0)),this._listenToWheelEvent&&this._removeWheelEventListener()}},surrenderPointer:{value:function(){var e=!0;return e&&this.isMoving&&this._releaseInterest(),e}},addEventListener:{value:function(e,t,r){n.addEventListener.call(this,e,t,r),"translate"===e&&(this._shouldDispatchTranslate=!0)}},capturePointerdown:{value:function(e){"mouse"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?this.captureMousedown(e):("touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.captureTouchstart(e)}},capturePointermove:{value:function(e){"mouse"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?this.captureMousemove(e):("touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.captureTouchmove(e)}},handlePointerup:{value:function(e){"mouse"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?this.handleMouseup(e):("touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.handleTouchend(e)}},handlePointercancel:{value:function(e){("touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.handleTouchcancel(e)}},captureMousedown:{value:function(e){this.enabled&&0===e.button&&(this._observedPointer="mouse",this._start(e.clientX,e.clientY,e.target,e.timeStamp))}},captureMousemove:{value:function(e){this.enabled&&this._handleMove(e)}},handleMouseup:{value:function(e){this.enabled&&this._end(e)}},captureTouchstart:{value:function(e){if(this.enabled&&null===this._observedPointer)if(void 0!==e.pointerId)this._observedPointer=e.pointerId,this._start(e.clientX,e.clientY,e.target,e.timeStamp),this._preventDefaultIfNeeded(e);else{var t=e.targetTouches;if(t&&1===t.length){var n=t[0];this._preventDefaultIfNeeded(e),this._observedPointer=n.identifier,this._start(n.clientX,n.clientY,n.target,e.timeStamp)}}}},captureTouchmove:{value:function(e){if(this.enabled)if(void 0!==e.pointerId)this._handleMove(e);else{var t=this._findObservedTouch(e.changedTouches);t&&this._handleMove(e,t)}}},handleTouchend:{value:function(e){if(this.enabled)if(void 0!==e.pointerId)this._end(e);else{var t=this._findObservedTouch(e.changedTouches);t&&this._end(t)}}},handleTouchcancel:{value:function(e){if(this.enabled)if(void 0!==e.pointerId)this._cancel(e);else{var t=this._findObservedTouch(e.changedTouches);t&&this._cancel(t)}}},captureScroll:{value:function(e){e.target.contains(this.element)&&this._cancel(e)}},_shouldPreventDefault:{value:function(e){return!!e.target.tagName&&-1===i._NATIVE_ELEMENTS.indexOf(e.target.tagName)&&!e.target.isContentEditable}},_preventDefaultIfNeeded:{value:function(e){!e.defaultPrevented&&this._shouldPreventDefault(e)&&e.preventDefault()}},_addWheelEventListener:{value:function(){if(this._element){var e=void 0!==window.onwheel||void 0!==window.WheelEvent?"wheel":"mousewheel";this._element.addEventListener(e,this,!1),this._element.addEventListener(e,this,!0)}}},_removeWheelEventListener:{value:function(){if(this._element){var e=void 0!==window.onwheel||void 0!==window.WheelEvent?"wheel":"mousewheel";this._element.removeEventListener(e,this,!1),this._element.removeEventListener(e,this,!0)}}},_start:{value:function(e,t,n,r){this.pointerStartEventPosition={pageX:e,pageY:t,target:n,timeStamp:r},this._pointerX=e,this._pointerY=t,window.PointerEvent?(document.addEventListener("pointermove",this,!0),document.addEventListener("pointerup",this,!1),document.addEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(document.addEventListener("MSPointerMove",this,!0),document.addEventListener("MSPointerUp",this,!1),document.addEventListener("MSPointerCancel",this,!1)):"mouse"===this._observedPointer?(document.addEventListener("mousemove",this,!0),document.addEventListener("mouseup",this,!1)):(this._element.addEventListener("touchmove",this,!0),this._element.addEventListener("touchend",this,!1),this._element.addEventListener("touchcancel",this,!1)),document.addEventListener("scroll",this,!0),this.isAnimating&&(this.isAnimating=!1,this._dispatchTranslateEnd()),this._isFirstMove=!0}},_findObservedTouch:{value:function(e){for(var t,n=null,r=0,i=e.length;i>r&&null===n;r++)t=e[r],t.identifier===this._observedPointer&&(n=t);return n}},_handleMove:{value:function(e,t){if(t||(t=e),this._isFirstMove){var r=this.eventManager.componentClaimingPointer(this._observedPointer);if(r){var a=!0;if(this.claimPointerPolicy===i.CLAIM_POINTER_POLICIES.MOVE){var o="mouse"===this._observedPointer?this._mouseRadiusThreshold:this._touchRadiusThreshold,s=this.pointerStartEventPosition.pageX-t.clientX,l=this.pointerStartEventPosition.pageY-t.clientY;a=n.isCoordinateOutsideRadius(s,l,o)}if(!a)return e.preventDefault(),void 0}this.eventManager.claimPointer(this._observedPointer,this)}this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?(e.preventDefault(),(this.allowTranslateOuterExtreme||this._shouldMove(e,t.clientX,t.clientY))&&(this._isFirstMove?this._firstMove():this._move(t.clientX,t.clientY))):this._releaseInterest()}},_shouldMove:{value:function(e,t,n){var r,i,a,o,s=this._translateY,l=this._translateX,u=!0;return"wheel"===e.type?("vertical"!==this._axis&&(a=20*(e.wheelDeltaY||-e.deltaY||0)/120),"horizontal"!==this._axis&&(o=20*(e.wheelDeltaY||-e.deltaY||0)/120)):("vertical"!==this._axis&&(a=-(this._invertXAxis?this._pointerX-t:t-this._pointerX)),"horizontal"!==this._axis&&(o=-(this._invertYAxis?this._pointerY-n:n-this._pointerY))),o&&(r=this._isNegativeNumber(o),null!==this.minTranslateY&&(u=s!==this.minTranslateY||s===this.minTranslateY&&r),null!==this.maxTranslateY&&u&&(u=s!==this.maxTranslateY||s===this.maxTranslateY&&!r)),a&&(i=this._isNegativeNumber(a),null!==this.minTranslateX&&u&&(u=l!==this.minTranslateX||l===this.minTranslateX&&i),null!==this.maxTranslateX&&u&&(u=l!==this.maxTranslateX||l===this.maxTranslateX&&!i)),u}},_firstMove:{value:function(){this._isFirstMove&&(this._dispatchTranslateStart(this._translateX,this._translateY),this._isFirstMove=!1,this.isMoving=!0)}},_move:{value:function(e,t){var n;this._isSelfUpdate=!0,"vertical"!==this._axis&&(n=this._invertXAxis?this._pointerX-e:e-this._pointerX,this.translateX+=n*this._pointerSpeedMultiplier),"horizontal"!==this._axis&&(n=this._invertYAxis?this._pointerY-t:t-this._pointerY,this.translateY+=n*this._pointerSpeedMultiplier),this._isSelfUpdate=!1,this._pointerX=e,this._pointerY=t,this._shouldDispatchTranslate&&this._dispatchTranslate()}},_end:{value:function(e){this.startTime=Date.now(),this.endX=this.posX=this.startX=this._translateX,this.endY=this.posY=this.startY=this._translateY;var t=e.velocity;this._hasMomentum&&(t.speed>40||this.translateStrideX||this.translateStrideY)?(this.momentumX="vertical"!==this._axis?t.x*this._pointerSpeedMultiplier*(this._invertXAxis?1:-1):0,this.momentumY="horizontal"!==this._axis?t.y*this._pointerSpeedMultiplier*(this._invertYAxis?1:-1):0,this.endX=this.startX-this.momentumX*this.__momentumDuration/2e3,this.endY=this.startY-this.momentumY*this.__momentumDuration/2e3,this.startStrideXTime=null,this.startStrideYTime=null,this.animateMomentum=!0):this.animateMomentum=!1,this.animateMomentum?this._animationInterval():this._isFirstMove||(this.isMoving=!1,this._dispatchTranslateEnd()),this._releaseInterest()}},_cancel:{value:function(){this.startTime=Date.now(),this.endX=this.posX=this.startX=this._translateX,this.endY=this.posY=this.startY=this._translateY,this.animateMomentum=!1,this._isFirstMove||(this.isMoving=!1,this._dispatchTranslateCancel()),this._releaseInterest()}},_releaseInterest:{value:function(){window.PointerEvent?(document.removeEventListener("pointermove",this,!0),document.removeEventListener("pointerup",this,!1),document.removeEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(document.removeEventListener("MSPointerMove",this,!0),document.removeEventListener("MSPointerUp",this,!1),document.removeEventListener("MSPointerCancel",this,!1)):"mouse"===this._observedPointer?(document.removeEventListener("mousemove",this,!0),document.removeEventListener("mouseup",this,!1)):(this._element.removeEventListener("touchmove",this,!0),this._element.removeEventListener("touchend",this,!1),this._element.removeEventListener("touchcancel",this,!1)),document.removeEventListener("scroll",this,!0),this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this.eventManager.forfeitPointer(this._observedPointer,this),this._observedPointer=null,this._isFirstMove=!1,this.isMoving=!1}},_isAxisMovement:{value:function(e){var t,n,r,i,a,o,s,l=e.velocity,u=.7853981633974483,c=2.356194490192345,h=-2.356194490192345,d=-.7853981633974483;if("both"===this.axis)return!0;if(!l||0===l.speed||isNaN(l.speed)?(o=this.pointerStartEventPosition.pageX-e.clientX,s=this.pointerStartEventPosition.pageY-e.clientY,a=Math.atan2(s,o)):a=l.angle,"horizontal"===this.axis){if(r=u>=a&&a>=d,i=a>=c||h>=a,r||i)return!0}else if("vertical"===this.axis&&(t=d>=a&&a>=h,n=a>=u&&c>=a,t||n))return!0;return!1}},_translateEndTimeout:{value:null},_handleWheelTimeout:{value:null},_isNegativeNumber:{value:function(e){return e=+e,isNaN(e)||(e=1/e),0>e}},captureWheel:{value:function(e){this._shouldMove(e)?this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)||this.eventManager.claimPointer(this._WHEEL_POINTER,this):this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)&&this.eventManager.forfeitPointer(this._WHEEL_POINTER,this)}},handleWheel:{value:function(e){if(this.enabled&&this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)){if(this._translateEndTimeout?window.clearTimeout(this._translateEndTimeout):this._dispatchTranslateStart(),this.translateY=this._translateY-20*(e.wheelDeltaY||-e.deltaY||0)/120,this.isMoving=!0,this._dispatchTranslate(),"function"!=typeof this._handleWheelTimeout){var t=function(){this._translateEndTimeout=null,this._dispatchTranslateEnd(),this.isMoving=!1,this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)&&this.eventManager.forfeitPointer(this._WHEEL_POINTER,this)};this._handleWheelTimeout=t.bind(this)}this._translateEndTimeout=window.setTimeout(this._handleWheelTimeout,400),e.preventDefault()}}},_bezierTValue:{value:function(e,t,n,r,i){var a,o,s,l,u=1-3*r+3*t,c=3*r-6*t,h=3*t,d=.5;for(o=0;10>o;o++)l=d*d,a=3*u*l+2*c*d+h,s=1-d,d-=(3*(s*s*d*t+s*l*r)+l*d-e)/a;return l=d*d,s=1-d,3*(s*s*d*n+s*l*i)+l*d}},_dispatchTranslateStart:{value:function(e,t){var n=document.createEvent("CustomEvent");n.initCustomEvent("translateStart",!0,!0,null),n.translateX=e,n.translateY=t,n.scroll=0,n.pointer=this._observedPointer,this.dispatchEvent(n)}},_dispatchTranslateEnd:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateEnd",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,this.dispatchEvent(e)}},_dispatchTranslateCancel:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateCancel",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,this.dispatchEvent(e)}},_dispatchTranslate:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translate",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},animateBouncingX:{value:!1,enumerable:!1},startTimeBounceX:{value:!1,enumerable:!1},animateBouncingY:{value:!1,enumerable:!1},startTimeBounceY:{value:!1,enumerable:!1},animateMomentum:{value:!1,enumerable:!1},startTime:{value:null,enumerable:!1},startX:{value:null,enumerable:!1},posX:{value:null,enumerable:!1},endX:{value:null,enumerable:!1},startY:{value:null,enumerable:!1},posY:{value:null,enumerable:!1},endY:{value:null,enumerable:!1},translateStrideX:{value:null},translateStrideY:{value:null},translateStrideDuration:{value:330},_animationInterval:{value:function(){var e,t,n,r,i=Date.now(),a=!1;this.animateMomentum&&(e=i-this.startTime,this.__momentumDuration>e?(this.posX=this.startX-(this.momentumX+this.momentumX*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this.posY=this.startY-(this.momentumY+this.momentumY*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this.translateStrideX&&null===this.startStrideXTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.posX-this.endX)<.75*this.translateStrideX)&&(this.startStrideXTime=i),this.translateStrideY&&null===this.startStrideYTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.posY-this.endY)<.75*this.translateStrideY)&&(this.startStrideYTime=i)):this.animateMomentum=!1),t=Math.round(this.endX/this.translateStrideX),this.startStrideXTime&&i-this.startStrideXTime>0&&(i-this.startStrideXTime<this.translateStrideDuration?(e=this._bezierTValue((i-this.startStrideXTime)/this.translateStrideDuration,.275,0,.275,1),this.posX=this.posX*(1-e)+t*this.translateStrideX*e,a=!0):this.posX=t*this.translateStrideX),t=Math.round(this.endY/this.translateStrideY),this.startStrideYTime&&i-this.startStrideYTime>0&&(i-this.startStrideYTime<this.translateStrideDuration?(e=this._bezierTValue((i-this.startStrideYTime)/this.translateStrideDuration,.275,0,.275,1),this.posY=this.posY*(1-e)+t*this.translateStrideY*e,a=!0):this.posY=t*this.translateStrideY),n=this.posX,r=this.posY,this._isSelfUpdate=!0,this.translateX=n,this.translateY=r,this._shouldDispatchTranslate&&this._dispatchTranslate(),this._isSelfUpdate=!1,this.isAnimating=this.animateMomentum||a,this.isAnimating?this.needsFrame=!0:this._dispatchTranslateEnd()
}}},{CLAIM_POINTER_POLICIES:{value:{DEFAULT:"default",MOVE:"move"}}});i.prototype.captureMSPointerDown=i.prototype.capturePointerdown,i.prototype.captureMSPointerMove=i.prototype.capturePointermove,i.prototype.handleMSPointerUp=i.prototype.handlePointerup,i.prototype.handleMSPointerCancel=i.prototype.handlePointercancel,i.prototype.handleMousewheel=i.prototype.handleWheel}}),montageDefine("aff95ef","composer/press-composer",{dependencies:["../core/core","./composer","../core/event/mutable-event"],factory:function(e,t){var n=e("../core/core").Montage,r=e("./composer").Composer,i=e("../core/event/mutable-event").MutableEvent,a=t.PressComposer=r.specialize({load:{value:function(){window.PointerEvent?this._element.addEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.addEventListener("MSPointerDown",this,!0):(this._element.addEventListener("touchstart",this,!0),this._element.addEventListener("mousedown",this,!0))}},unload:{value:function(){window.PointerEvent?this._element.removeEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.removeEventListener("MSPointerDown",this,!0):(this._element.removeEventListener("touchstart",this,!0),this._element.removeEventListener("mousedown",this,!0))}},delegate:{value:null},cancelPress:{value:function(){return this._state===a.PRESSED?(this._cancelPress(),!0):!1}},_cancelPress:{value:function(e){this._dispatchPressCancel(e),this._endInteraction()}},addEventListener:{value:function(e,t,n){r.addEventListener.call(this,e,t,n),"longPress"===e&&(this._shouldDispatchLongPress=!0)}},UNPRESSED:{value:0},PRESSED:{value:1},CANCELLED:{value:2},_state:{value:0},state:{get:function(){return this._state}},_shouldDispatchLongPress:{value:!1},_longPressThreshold:{value:1e3},longPressThreshold:{get:function(){return this._longPressThreshold},set:function(e){this._longPressThreshold!==e&&(this._longPressThreshold=e)}},_longPressTimeout:{value:null},_observedPointer:{value:null},_initialCenterPositionX:{value:0},_initialCenterPositionY:{value:0},_shouldSaveInitialCenterPosition:{value:!1},_endInteraction:{value:function(){this._element&&(this._removeEventListeners(),this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this.component.eventManager.forfeitPointer(this._observedPointer,this),this._observedPointer=null,this._state=a.UNPRESSED,this._initialCenterPositionX=0,this._initialCenterPositionY=0,this._shouldSaveInitialCenterPosition=!1)}},_changedTouchisObserved:{value:function(e){if(null===this._observedPointer)return!1;for(var t=0,n=e.length;n>t;t++)if(e[t].identifier===this._observedPointer)return t;return!1}},surrenderPointer:{value:function(e,t){var n=this.callDelegateMethod("surrenderPointer",e,t);return void 0!==n&&n===!1?!1:(this._cancelPress(),!0)}},_shouldPerformPress:{value:function(){return!("enabled"in this.component&&!this.component.enabled||null!==this._observedPointer)}},capturePointerdown:{value:function(e){"touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH?this.captureTouchstart(e):("mouse"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE)&&this.captureMousedown(e)}},handlePointerup:{value:function(e){"touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH?this.handleTouchend(e):("mouse"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE)&&this.handleMouseup(e)}},handlePointercancel:{value:function(e){("touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.handleTouchcancel(e)}},captureTouchstart:{value:function(e){this._shouldPerformPress()&&(void 0!==e.pointerId?this._observedPointer=e.pointerId:e.changedTouches&&1===e.changedTouches.length&&(this._observedPointer=e.changedTouches[0].identifier),null!==this._observedPointer&&this.component.eventManager.claimPointer(this._observedPointer,this)?(this._shouldSaveInitialCenterPosition=!0,this._addEventListeners(),this._dispatchPressStart(e)):this._observedPointer=null)}},handleTouchend:{value:function(e){if(null===this._observedPointer)return this._endInteraction(e),void 0;var t;if(e.pointerId===this._observedPointer)t=e.target;else if(this._changedTouchisObserved(e.changedTouches)!==!1){var n=e.changedTouches[0];t=document.elementFromPoint(n.clientX,n.clientY)}t&&this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&(this.element===t||this.element.contains(t)?this._dispatchPress(e):this._dispatchPressCancel(e),this._endInteraction(e))}},_saveInitialCenterPositionIfNeeded:{value:function(){this._shouldSaveInitialCenterPosition&&(this._saveInitialCenterPosition(),this._shouldSaveInitialCenterPosition=!1)}},_handleMove:{value:function(e){return null===this._observedPointer?(this._endInteraction(e),void 0):(("mouse"===this._observedPointer||e.pointerId===this._observedPointer||e.changedTouches&&this._changedTouchisObserved(e.changedTouches)!==!1)&&this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&(this._saveInitialCenterPositionIfNeeded(),this._positionChanged&&this._cancelPress(e)),void 0)}},captureWheel:{value:function(e){return null===this._observedPointer?(this._endInteraction(e),void 0):((e.target===this.element||e.target===window||"function"==typeof e.target.contains&&e.target.contains(this.element)||this.element.contains(e.target))&&(this._saveInitialCenterPositionIfNeeded(),this._positionChanged&&this._cancelPress(e)),void 0)}},handleTouchcancel:{value:function(e){(null===this._observedPointer||e.pointerId===this._observedPointer||this._changedTouchisObserved(e.changedTouches)!==!1)&&(this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this._dispatchPressCancel(e),this._endInteraction(e))}},captureMousedown:{value:function(e){0===e.button&&this._shouldPerformPress()&&(this._observedPointer="mouse",this.component.eventManager.claimPointer(this._observedPointer,this),this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?(this._shouldSaveInitialCenterPosition=!0,this._addEventListeners(),this._dispatchPressStart(e)):this._observedPointer=null)}},captureScroll:{value:function(e){(e.target===this.element||e.target===window||"function"==typeof e.target.contains&&e.target.contains(this.element)||this.element.contains(e.target))&&this._cancelPress(e)}},handleMouseup:{value:function(e){if(null===this._observedPointer)return this._endInteraction(e),void 0;if(this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)){for(var t=e.target;t!==this._element&&t&&t.parentNode;)t=t.parentNode;if(t===this._element)return this._dispatchPress(e),this._endInteraction(e),void 0}this._cancelPress(e)}},handleDragstart:{value:function(e){this._cancelPress(e)}},_saveInitialCenterPosition:{value:function(){var e=this.element.getBoundingClientRect();this._initialCenterPositionX=e.left+e.width/2,this._initialCenterPositionY=e.top+e.height/2}},_positionChanged:{get:function(){var e=this.element.getBoundingClientRect(),t=e.left+e.width/2,n=e.top+e.height/2;return this._initialCenterPositionX!==t||this._initialCenterPositionY!==n}},_addEventListeners:{value:function(){window.PointerEvent?(document.addEventListener("pointerup",this,!1),document.addEventListener("pointermove",this,!1),document.addEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(document.addEventListener("MSPointerUp",this,!1),document.addEventListener("MSPointerMove",this,!1),document.addEventListener("MSPointerCancel",this,!1)):"mouse"===this._observedPointer?(document.addEventListener("mouseup",this,!1),document.addEventListener("mousemove",this,!1),this._element.addEventListener("dragstart",this,!1)):(document.addEventListener("touchend",this,!1),document.addEventListener("touchcancel",this,!1),document.addEventListener("touchmove",this,!1));var e=void 0!==window.onwheel||void 0!==window.WheelEvent?"wheel":"mousewheel";document.addEventListener(e,this,!0),document.addEventListener("scroll",this,!0)}},_removeEventListeners:{value:function(){window.PointerEvent?(document.removeEventListener("pointerup",this,!1),document.removeEventListener("pointermove",this,!1),document.removeEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(document.removeEventListener("MSPointerUp",this,!1),document.removeEventListener("MSPointerMove",this,!1),document.removeEventListener("MSPointerCancel",this,!1)):"mouse"===this._observedPointer?(document.removeEventListener("mouseup",this,!1),document.removeEventListener("mousemove",this,!1),this._element.removeEventListener("dragstart",this,!1)):(document.removeEventListener("touchend",this,!1),document.removeEventListener("touchcancel",this,!1),document.removeEventListener("touchmove",this,!1));var e=void 0!==window.onwheel||void 0!==window.WheelEvent?"wheel":"mousewheel";document.removeEventListener(e,this,!0),document.removeEventListener("scroll",this,!0)}},_createPressEvent:{enumerable:!1,value:function(e,t){var n,r,i=t;return t||(t=document.createEvent("CustomEvent"),t.initCustomEvent(e,!0,!0,null)),n=new o,n.event=t,n.type=e,n.pointer=this._observedPointer,n.targetElement=t.target,t.changedTouches&&(r=this._changedTouchisObserved(t.changedTouches))!==!1&&(i=n.touch=t.changedTouches[r]),i&&(n.clientX=i.clientX,n.clientY=i.clientY,n.pageX=i.pageX,n.pageY=i.pageY),n}},_dispatchPressStart:{enumerable:!1,value:function(e){if(this._state=a.PRESSED,this.dispatchEvent(this._createPressEvent("pressStart",e)),this._shouldDispatchLongPress){var t=this;this._longPressTimeout=setTimeout(function(){t._dispatchLongPress()},this._longPressThreshold)}}},_dispatchPress:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(clearTimeout(this._longPressTimeout),this._longPressTimeout=null),this.dispatchEvent(this._createPressEvent("press",e)),this._state=a.UNPRESSED}},_dispatchLongPress:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(this.dispatchEvent(this._createPressEvent("longPress",e)),this._longPressTimeout=null)}},_dispatchPressCancel:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(clearTimeout(this._longPressTimeout),this._longPressTimeout=null),this._state=a.CANCELLED,this.dispatchEvent(this._createPressEvent("pressCancel",e))}}});a.prototype.captureMSPointerDown=a.prototype.capturePointerdown,a.prototype.handleMSPointerUp=a.prototype.handlePointerup,a.prototype.handleMSPointerCancel=a.prototype.handlePointercancel,a.prototype.handleMSPointerMove=a.prototype._handleMove,a.prototype.handlePointermove=a.prototype._handleMove,a.prototype.handleTouchmove=a.prototype._handleMove,a.prototype.handleMousemove=a.prototype._handleMove,a.prototype.handleMousewheel=a.prototype.handleWheel;var o=function(){var e,t,r,a,o,s;for(e=i.specialize({type:{value:"press"},_event:{enumerable:!1,value:null},event:{get:function(){return this._event},set:function(e){this._event=e}},_touch:{enumerable:!1,value:null},touch:{get:function(){return this._touch},set:function(e){this._touch=e}}}),t=["altKey","ctrlKey","metaKey","shiftKey","cancelBubble","currentTarget","defaultPrevented","eventPhase","timeStamp","preventDefault","stopImmediatePropagation","stopPropagation"],r=["clientX","clientY","pageX","pageY","screenX","screenY","target"],a=function(e){return{get:function(){return this._event[e]}}},o=function(e){return{get:function(){return this._touch?this._touch[e]:this._event[e]}}},s=t.length-1;s>=0;s--)n.defineProperty(e,t[s],a(t[s]));for(s=r.length-1;s>=0;s--)n.defineProperty(e,r[s],o(r[s]));return e}()}}),montageDefine("aff95ef","ui/flow.reel/flow-translate-composer",{dependencies:["../../core/core","../../composer/translate-composer","../../core/event/event-manager","../../core/geometry/point","../../core/dom"],factory:function(e,t){var n=(e("../../core/core").Montage,e("../../composer/translate-composer").TranslateComposer),r=(e("../../core/event/event-manager").defaultEventManager,e("../../core/geometry/point").Point),i=e("../../core/dom").convertPointFromPageToNode;t.FlowTranslateComposer=n.specialize({constructor:{value:function(){this.super(),this.handleMousewheel=this.handleWheel}},stealChildrenPointer:{value:!0},_linearScrollingVector:{value:[-300,0]},linearScrollingVector:{get:function(){return this._linearScrollingVector},set:function(e){this._linearScrollingVector=e}},startTranslateSpeed:{value:500},startTranslateRadius:{value:8},_startPageX:{value:null},_startPageY:{value:null},_pageX:{value:null},_pageY:{value:null},_pointerStartX:{value:null},_pointerStartY:{value:null},_contentOffsetX:{value:null},_contentOffsetY:{value:null},_superStart:{value:n.prototype._start},_start:{value:function(e,t,n,a){this._superStart(e,t,n,a);var o=window.getComputedStyle(this._element,null),s=this.convertCssPixelsPropertyStringToNumber(o.getPropertyValue("border-left-width")),l=this.convertCssPixelsPropertyStringToNumber(o.getPropertyValue("border-top-width")),u=this.convertCssPixelsPropertyStringToNumber(o.getPropertyValue("padding-left")),c=this.convertCssPixelsPropertyStringToNumber(o.getPropertyValue("padding-top")),h=i(this._element,(new r).init(e,t));this._pointerStartX=this._pointerX=h.x-s-u,this._pointerStartY=this._pointerY=h.y-l-c,this._contentOffsetX=this._startPageX-this._pointerStartX,this._contentOffsetY=this._startPageY-this._pointerStartY,this._computePointedElement(),this._startPageX=this._pageX=e,this._startPageY=this._pageY=t,this._startScroll=this._scroll,this._previousScrollDelta=0,this._scrollEnd=null}},_analyzeMovement:{value:function(e){var t,n,r,i=e.velocity;i&&(t=i.speed,t>=this.startTranslateSpeed?this._stealPointer():(n=this.startPageX-e.pageX,r=this.startPageY-e.pageY,n*n+r*r>this.startTranslateRadius*this.startTranslateRadius&&this._stealPointer()))}},_dispatchTranslateStart:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateStart",!0,!0,null),e.scroll=this._scroll,e.translateX=0,e.translateY=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_dispatchTranslateEnd:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateEnd",!0,!0,null),e.scroll=this._scroll,e.translateX=0,e.translateY=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_dispatchTranslateCancel:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateCancel",!0,!0,null),e.scroll=this._scroll,e.translateX=0,e.translateY=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_dispatchTranslate:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translate",!0,!0,null),e.scroll=this._scroll,e.translateX=0,e.translateY=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_move:{value:function(e,t){this._isFirstMove&&(this._dispatchTranslateStart(),this._isFirstMove=!1),this._pageX=e,this._pageY=t,this._updateLinearScroll(),this._shouldDispatchTranslate&&this._dispatchTranslate()}},_end:{value:function(e){if(this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)){this.startTime=Date.now(),this.endX=this.startX=this._pageX,this.endY=this.startY=this._pageY;var t=e.velocity;this._hasMomentum&&(t.speed>40||this.translateStrideX||this.translateStrideY)?(this.momentumX="vertical"!=this._axis?t.x*this._pointerSpeedMultiplier*(this._invertXAxis?1:-1):0,this.momentumY="horizontal"!=this._axis?t.y*this._pointerSpeedMultiplier*(this._invertYAxis?1:-1):0,this.endX=this.startX+this.momentumX*this.__momentumDuration/2e3,this.endY=this.startY+this.momentumY*this.__momentumDuration/2e3,this.startStrideXTime=null,this.startStrideYTime=null,this.animateMomentum=!0):this.animateMomentum=!1,this.animateMomentum?this._animationInterval():this._isFirstMove||this._dispatchTranslateEnd()}this._releaseInterest()}},_translateEndTimeout:{value:null},_mousewheelStrideTimeout:{value:null},_previousDeltaY:{value:0},_listenToWheelEvent:{value:!0},captureWheel:{value:function(){this.eventManager.componentClaimingPointer(this._WHEEL_POINTER)||this.eventManager.claimPointer(this._WHEEL_POINTER,this.component)}},handleWheel:{value:function(e){var t=this;if(this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this.component)){var n=this._pageY,r=e.wheelDeltaY||-e.deltaY||0;this.translateStrideX?(window.clearTimeout(this._mousewheelStrideTimeout),(null===this._mousewheelStrideTimeout||Math.abs(r)>Math.abs(this._previousDeltaY*(null===this._mousewheelStrideTimeout?2:4)))&&(r>1?this.callDelegateMethod("previousStride",this):-1>r&&this.callDelegateMethod("nextStride",this)),this._mousewheelStrideTimeout=window.setTimeout(function(){t._mousewheelStrideTimeout=null,t._previousDeltaY=0},70),t._previousDeltaY=r,this._shouldPreventDefault(e)&&e.preventDefault()):(null===this._translateEndTimeout&&this._dispatchTranslateStart(),this._pageY=this._pageY+20*r/100,this._updateScroll(),this._dispatchTranslate(),window.clearTimeout(this._translateEndTimeout),this._translateEndTimeout=window.setTimeout(function(){t._dispatchTranslateEnd(),t._translateEndTimeout=null},400),n!==this._pageY&&this._shouldPreventDefault(e)&&e.preventDefault()),this.eventManager.forfeitPointer(this._WHEEL_POINTER,this.component)}}},_scroll:{value:0},scroll:{get:function(){return this._scroll},set:function(e){null!==this.minScroll&&this.minScroll>e&&(e=this.minScroll),null!==this.maxScroll&&e>this.maxScroll&&(e=this.maxScroll),this._scroll=e}},minScroll:{value:null},maxScroll:{value:null},_flow:{value:null},flow:{get:function(){return this._flow},set:function(e){this._flow=e,this.component=e}},_updateScroll:{value:function(){this._updateLinearScroll()}},_updateLinearScroll:{value:function(){var e=this._flow,t=e.isCameraEnabled?500/e._height:1,n=(this._pageX-this._startPageX)*this._linearScrollingVector[0]*t*e._sceneScaleX.denominator/e._sceneScaleX.numerator,r=(this._pageY-this._startPageY)*this._linearScrollingVector[1]*t*e._sceneScaleY.denominator/e._sceneScaleY.numerator,i=this._linearScrollingVector[0]*this._linearScrollingVector[0]+this._linearScrollingVector[1]*this._linearScrollingVector[1],a=(n+r)/i;this.scroll+=a-this._previousScrollDelta,this._previousScrollDelta=a}},frame:{value:function(){this.isAnimating&&this._animationInterval()}},convertCssPixelsPropertyStringToNumber:{value:function(e){return"string"==typeof e?"px"===e.substr(-2)?1*e.substr(0,e.length-2):0:0}},_rayPointDistance:{value:function(e,t){var n,r,i,a,o;return n=e[0]*t[0]+e[1]*t[1]+e[2]*t[2],n>=0?(r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n/=r,i=e[0]*n-t[0],a=e[1]*n-t[1],o=e[2]*n-t[2],Math.sqrt(i*i+a*a+o*o)):!1}},_closerIndex:{value:null},_computePointedElement:{value:function(){var e=this._flow._splinePaths,t=e.length;if(t){var n,r,i,a,o,s,l,u,c,h=this._flow,d=h._viewpointTargetPoint[0]-h._viewpointPosition[0],p=h._viewpointTargetPoint[2]-h._viewpointPosition[2],f=Math.atan2(d,p),m=p*Math.cos(-f)-d*Math.sin(-f),v=Math.atan2(h._viewpointTargetPoint[1]-h._viewpointPosition[1],m),g=.5*this._element.clientWidth-this._pointerX,_=this._pointerY-.5*this._element.clientHeight,b=.5*this._element.offsetHeight/Math.tan(h._viewpointFov*h._doublePI*(1/720)),y=[],w=h._visibleIndexes,E=w.length,C=h._sceneScale,x=null,S=1e100;for(r=b*Math.cos(v)-_*Math.sin(v),_=b*Math.sin(v)+_*Math.cos(v),n=r*Math.cos(f)-g*Math.sin(f),g=r*Math.sin(f)+g*Math.cos(f),l=[g,_,n],c=0;e.length>c;c++)for(c=0;e.length>c;c++)y[c]=e[c].transform([C.x.numerator/C.x.denominator,0,0,0,0,C.y.numerator/C.y.denominator,0,0,0,0,C.z.numerator/C.z.denominator,0,-h._viewpointPosition[0]+.5*h._firstIterationWidth+h._firstIterationOffsetLeft,-h._viewpointPosition[1]+.5*h._firstIterationHeight+h._firstIterationOffsetTop,-h._viewpointPosition[2],1]);for(c=0;E>c;c++)u=this._flow.offset(w[c]),i=u.pathIndex,a=u.slideTime,s=y[i]._convertSplineTimeToBezierIndexTime(a),null!==s&&(pos=y[i].getPositionAtIndexTime(s),o=this._rayPointDistance(l,pos),o!==!1&&S>o&&(S=o,x=w[c]));this._closerIndex=x}}},_previousScrollDelta:{value:0},_startScroll:{value:0},_translateStride:{value:null},translateStride:{get:function(){return this._translateStride},set:function(e){this._translateStride=e,this.translateStrideX=e}},_scrollEnd:{value:null},_scrollStart:{value:null},_hasMomentum:{value:!0},isLimitedToSingleStride:{value:!1},_animationInterval:{value:function(){var e,t,n,r,i,a,o=Date.now(),s=!1;i=this.minScroll,a=this.maxScroll,this.minScroll=null,this.maxScroll=null,null===this._scrollEnd&&(this._scrollStart=this.scroll,this._pageX=this.endX,this._pageY=this.endY,this._updateScroll(),this._scrollEnd=this.scroll,this.isLimitedToSingleStride&&this.translateStrideX&&(this._scrollEnd>Math.floor(this._scrollStart)+this.translateStrideX&&(this._scrollEnd=Math.floor(this._scrollStart)+this.translateStrideX),this._scrollEnd<Math.ceil(this._scrollStart)-this.translateStrideX&&(this._scrollEnd=Math.ceil(this._scrollStart)-this.translateStrideX)),this._pageX=this.startX,this._pageY=this.startY,this._updateScroll()),this.animateMomentum?(e=o-this.startTime,this.__momentumDuration>e?(this._pageX=this.startX+(this.momentumX+this.momentumX*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this._pageY=this.startY+(this.momentumY+this.momentumY*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this._updateScroll(),this.translateStrideX&&null===this.startStrideXTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.scroll-this._scrollEnd)<.75*this.translateStrideX)&&(this.startStrideXTime=o,this._strideStartScroll=this._scroll)):this.animateMomentum=!1):null===this.startStrideXTime&&(this.startStrideXTime=this.startTime,this._strideStartScroll=this._scrollStart),r=this.scroll,this.startStrideXTime&&o-this.startStrideXTime>0&&(n=Math.round(this._scrollEnd/this.translateStrideX),o-this.startStrideXTime<this.translateStrideDuration?(e=this._bezierTValue((o-this.startStrideXTime)/this.translateStrideDuration,.275,0,.275,1),t=(o-this.startStrideXTime)/this.translateStrideDuration,r=r*(1-t)+(n*this.translateStrideX*e+this._strideStartScroll*(1-e))*t,s=!0):(r=n*this.translateStrideX,this.animateMomentum=!1)),this.minScroll=i,this.maxScroll=a,i>r&&(r=i,this.animateMomentum=!1,s=!1),r>a&&(r=a,this.animateMomentum=!1,s=!1),this.scroll=r,this.isAnimating=this.animateMomentum||s,this.isAnimating?this.needsFrame=!0:(this._dispatchTranslateEnd(),this._scrollEnd=null)}}})}}),montageDefine("aff95ef","core/range-controller",{dependencies:["./core","collections/generic-collection","collections/listen/array-changes"],factory:function(e,t){var n=e("./core").Montage,r=e("collections/generic-collection"),i=e("collections/listen/array-changes").observableArrayProperties,a=Object.freeze([]),o=function(e,t){var n=e;return n.__proto__=o.prototype,n.rangeController=t,n.contentEquals=e&&e.contentEquals||Object.is,n};o.prototype=Object.create(Array.prototype,i),Object.defineProperty(o.prototype,"clone",{value:function(){return this.slice()}}),self.swap,Object.defineProperty(o.prototype,"oldSwap",{configurable:!1,value:i.swap.value}),Object.defineProperty(o.prototype,"swap",{configurable:!1,value:function(e,t,n){return this.swap_or_push(e,t,n)}}),o.prototype.oldPush=i.push.value,Object.defineProperty(o.prototype,"push",{configurable:!1,value:function(){for(var e=-1,t=arguments.length,n=Array(t);t>++e;)n[e]=arguments[e];this.swap_or_push(this.length,0,n)}}),Object.defineProperty(o.prototype,"swap_or_push",{configurable:!1,value:function(e,t,n){var r=this.rangeController.content;this.contentEquals=r&&r.contentEquals||Object.is,e=e>=0?e:this.length+e;var i=this.length,o=Math.min(t,i-e);if(n){n.contentEquals=this.contentEquals;var s=n.filter(function(t,i){if(r&&!r.has(t))return!1;if(n.findLast(t)>i)return!1;var a=this.find(t);return 0>a||a>=e&&e+o>a},this)}else s=a;var l;l=0===o?a:Array.prototype.slice.call(this,e,e+o);var u=s.length-l.length,c=Math.max(this.length+u,e+s.length);if(!this.rangeController.multiSelect&&c>1){var h=s.length?s[s.length-1]:this.one();return 0===i?(this.oldPush(h),a):this.oldSwap(0,i,[h])}return this.rangeController.avoidsEmptySelection&&0===c?r.has(this[0])?0===this.length-1?a:this.oldSwap(1,this.length-1):0===this.length?(this.oldPush(r.one()),a):this.oldSwap(0,this.length,[r.one()]):this.oldSwap(e,t,s)}}),t.RangeController=n.specialize({constructor:{value:function(e){this.content=null,this._selection=new o([],this),this.sortPath=null,this.filterPath=null,this.reversed=!1,this.selectAddedContent=!1,this.deselectInvisibleContent=!1,this.clearSelectionOnOrderChange=!1,this.avoidsEmptySelection=!1,this.multiSelect=!1,this.organizedContent=[],this.organizedContent.addRangeChangeListener(this,"organizedContent"),this.defineBinding("_filteredContent",{"<-":"$filterPath.defined() ? content.filter{path($filterPath)} : content"}),this.defineBinding("_sortedContent",{"<-":"$sortPath.defined() ? _filteredContent.sorted{path($sortPath)} : _filteredContent"}),this.defineBinding("organizedContent.rangeContent()",{"<-":"$reversed ?? 0 ? _sortedContent.reversed() : _sortedContent"}),this.addRangeAtPathChangeListener("content",this,"handleContentRangeChange"),this.addPathChangeListener("sortPath",this,"handleOrderChange"),this.addPathChangeListener("reversed",this,"handleOrderChange"),this.addOwnPropertyChangeListener("multiSelect",this),this.iterations=[],e&&this.initWithContent(e)}},initWithContent:{value:function(e){return this.content=e,this}},sortPath:{value:null},reversed:{value:null},filterPath:{value:null},selectAddedContent:{value:!1},deselectInvisibleContent:{value:!1},clearSelectionOnOrderChange:{value:!1},avoidsEmptySelection:{value:!1},multiSelect:{value:!1},organizedContent:{value:null},iterations:{value:null},_selection:{value:null},selection:{get:function(){return this._selection},set:function(e){var t=[0,this._selection.length];e&&e.toArray&&(t=t.concat(e.toArray())),this._selection.splice.apply(this._selection,t)}},select:{value:function(e){!this.multiSelect&&this.selection.length>=1&&this.selection.clear(),this.selection.add(e)}},deselect:{value:function(e){(!this.avoidsEmptySelection||this.selection.length>1)&&this.selection["delete"](e)}},clearSelection:{value:function(){(!this.avoidsEmptySelection||this.selection.length>1)&&this.selection.clear()}},add:{value:function(e){var t;return this.content||(this.content=[]),t=this.content.add(e),t&&this.handleAdd(e),t}},push:{value:function(){for(var e=this.content.push.apply(this.content,arguments),t=0;arguments.length>t;t++)this.handleAdd(arguments[t]);return e}},pop:{value:function(){return this.content.pop()}},shift:{value:function(){return this.content.shift()}},unshift:{value:function(){for(var e=this.content.unshift.apply(this.content,arguments),t=0;arguments.length>t;t++)this.handleAdd(arguments[t]);return e}},splice:{value:function(){for(var e=this.content.splice.apply(this.content,arguments),t=2;arguments.length>t;t++)this.handleAdd(arguments[t]);return e}},swap:{value:function(e,t,n){var r=this.content.swap.apply(this.content,arguments);if(n)for(var e=2;n.length>e;e++)this.handleAdd(n[e]);return r}},"delete":{value:function(e){return this.content["delete"](e)}},has:{value:function(e){return this.content?this.content.has(e):!1}},addEach:{value:r.prototype.addEach},deleteEach:{value:r.prototype.deleteEach},clear:{value:function(){this.content.clear()}},addContent:{value:function(){var e=new this.contentConstructor;return this.add(e),e}},_contentConstructor:{value:null},contentConstructor:{get:function(){return this._contentConstructor?this._contentConstructor:this.content&&this.content.contentConstructor?this.content.contentConstructor:Object},set:function(e){this._contentConstructor=e}},handleContentRangeChange:{value:function(e,t){if(this.selection.length>0){var n=this.content&&this.content.contentEquals||Object.is;t.deleteEach(e,n),this.selection&&this.selection.deleteEach(t)}}},handleSelectionRangeChange:{value:function(e,t){if(this.selection)if(this.content){for(var n=[],r=0;e.length>r;r++)this.content.has(e[r])||n.push(e[r]);if(this._selection.deleteEach(n),!this.multiSelect&&this._selection.length>1){var i=this._selection.pop();this._selection.clear(),this._selection.add(i)}this.avoidsEmptySelection&&0==this._selection.length&&this._selection.add(t[0])}else this._selection.clear()}},handleOrganizedContentRangeChange:{value:function(e,t){if(this.deselectInvisibleContent&&this.selection){var n=t.clone(1);n.deleteEach(e),this.selection.deleteEach(t)}}},handleOrderChange:{value:function(){this.clearSelectionOnOrderChange&&this.selection&&this.selection.clear()}},handleAdd:{value:function(e){this.selectAddedContent&&this.selection&&(!this.multiSelect&&this.selection.length>=1&&this.selection.clear(),this.selection.add(e))}},handleMultiSelectChange:{value:function(){if(this.selection){var e=this.selection.length;if(!this.multiSelect&&e>1){var t=this._selection.pop();this._selection.clear(),this._selection.add(t)}}}}},{blueprintModuleId:e("./core")._blueprintModuleIdDescriptor,blueprint:e("./core")._blueprintDescriptor})}}),montageDefine("aff95ef","ui/flow.reel/flow-bezier-spline",{dependencies:["../../core/core"],factory:function(e,t){var n=e("../../core/core").Montage,r=t.FlowBezierSpline=n.specialize({constructor:{value:function r(){this._knots=[],this._densities=[]}},knots:{get:function(){return this._knots},set:function(e){this._knots=e}},previousHandlers:{get:function(){return this._previousHandlers||(this._previousHandlers=[]),this._previousHandlers},set:function(e){this._previousHandlers=e}},nextHandlers:{get:function(){return this._nextHandlers||(this._nextHandlers=[]),this._nextHandlers},set:function(e){this._nextHandlers=e}},densities:{get:function(){return this._densities},set:function(e){this._densities=e,this._densitiesLength=this._densities.length,this._maxTime=null}},_parameters:{value:{}},parameters:{get:function(){return this._parameters||(this._parameters={}),this._parameters},set:function(e){this._parameters=e,this._parametersLength=this._parameters.length}},_maxTime:{enumerable:!1,value:null},computeMaxTime:{value:function(){return this._computeDensitySummation(),this._maxTime=this._densitySummation.length?this._densitySummation[this._densitySummation.length-1]:0,this._maxTime}},_densitySummation:{enumerable:!1,value:null},_computeDensitySummation:{enumerable:!1,value:function(){var e,t=this.densities,n=t.length-1,r=0;for(this._densitySummation=[],e=0;n>e;e++)r+=(t[e]+t[e+1])/2,this._densitySummation[e]=r;this._maxTime=null}},_convertSplineTimeToBezierIndexTime:{enumerable:!1,value:function(e){if(0>e)return null;if(null===this._maxTime&&this.computeMaxTime(),e>=this._maxTime)return null;for(var t,n,r,i,a,o=this._densitySummation,s=o.length,l=s-1,u=s>>1;u;)l-u>=0&&o[l-u]>e?l-=u:u>>=1;return t=e-(l?o[l-1]:0),r=this._densities[l],i=this._densities[l+1],a=r-i,n=-1e-10>a||a>1e-10?(r-Math.sqrt(r*r+2*(i-r)*t))/a:t/r,[l,n]}},getPositionAtIndexTime:{value:function(e,t){var n=e[0],r=e[1],i=this._knots[n],a=this._nextHandlers[n],o=this._previousHandlers[n+1],s=this._knots[n+1],l=1-r,u=l*l*l,c=3*l*l*r,h=3*l*r*r,d=r*r*r;return t?[t.x.numerator*(i[0]*u+a[0]*c+o[0]*h+s[0]*d)/t.x.denominator,t.y.numerator*(i[1]*u+a[1]*c+o[1]*h+s[1]*d)/t.y.denominator,t.z.numerator*(i[2]*u+a[2]*c+o[2]*h+s[2]*d)/t.z.denominator]:[i[0]*u+a[0]*c+o[0]*h+s[0]*d,i[1]*u+a[1]*c+o[1]*h+s[1]*d,i[2]*u+a[2]*c+o[2]*h+s[2]*d]}},getRotationAtIndexTime:{value:function(e){var t,n,r,i=e[0],a=e[1],o=1-a,s=this._parameters;return t=void 0!==s.rotateX?s.rotateX.data[i]*o+s.rotateX.data[i+1]*a:0,n=void 0!==s.rotateY?s.rotateY.data[i]*o+s.rotateY.data[i+1]*a:0,r=void 0!==s.rotateZ?s.rotateZ.data[i]*o+s.rotateZ.data[i+1]*a:0,[t,n,r]}},getStyleAtIndexTime:{value:function(e){var t,n,r,i,a,o,s=e[0],l=e[1],u=this._parameters,c=1-l,h="";for(r=Object.keys(u),i=r.length,t=0;i>t;t++)n=r[t],a=u[n],o=a.data,"rotateX"!==n&&"rotateY"!==n&&"rotateZ"!==n&&void 0!==o[s]&&void 0!==o[s+1]&&(h+=n+":"+1e-5*(1e5*(o[s]*c+o[s+1]*l)>>0)+a.units+";");
return h}},transformVectorArray:{value:function(e,t){var n,r,i=e.length,a=[];for(r=0;i>r;r++)n=e[r],n&&(a[r]=[n[0]*t[0]+n[1]*t[4]+n[2]*t[8]+t[12],n[0]*t[1]+n[1]*t[5]+n[2]*t[9]+t[13],n[0]*t[2]+n[1]*t[6]+n[2]*t[10]+t[14]]);return a}},transform:{value:function(e){var t=new r;return t._densities=this._densities,t._densitySummation=this._densitySummation,t._knots=this.transformVectorArray(this.knots,e),t._previousHandlers=this.transformVectorArray(this.previousHandlers,e),t._nextHandlers=this.transformVectorArray(this.nextHandlers,e),t}},deCasteljau:{value:function(e,t,n,r,i){var a=1-i,o=a*e[0]+i*t[0],s=a*t[0]+i*n[0],l=a*n[0]+i*r[0],u=a*o+i*s,c=a*s+i*l,h=a*u+i*c,d=a*e[1]+i*t[1],p=a*t[1]+i*n[1],f=a*n[1]+i*r[1],m=a*d+i*p,v=a*p+i*f,g=a*m+i*v,_=a*e[2]+i*t[2],b=a*t[2]+i*n[2],y=a*n[2]+i*r[2],w=a*_+i*b,E=a*b+i*y,C=a*w+i*E;return[[e,[o,d,_],[u,m,w],[h,g,C]],[[h,g,C],[c,v,E],[l,f,y],r]]}},cubic:{enumerable:!1,value:function(e,t,n,r,i){return((e*i+t)*i+n)*i+r}},cubeRoot:{enumerable:!1,value:function(e){return e>0?Math.pow(e,1/3):-Math.pow(-e,1/3)}},cubicRealRoots:{enumerable:!1,value:function(e,t,n,r){var i=1e-10,a=Math;if(-i>e||e>i){var o=1/e,s=t*o,l=n*o,u=(3*l-s*s)*(1/9),c=(4.5*s*l-13.5*r*o-s*s*s)*(1/27),h=u*u*u+c*c;if(h>i){var d=a.sqrt(h);return[this.cubeRoot(c+d)+this.cubeRoot(c-d)+s*(-1/3)]}if(h>-i){if(-i>c||c>i){var p=this.cubeRoot(c),f=2*p+s*(-1/3),m=s*(-1/3)-p;return m>f?[f,m]:[m,f]}return[s*(-1/3)]}var v=a.acos(c/a.sqrt(-u*u*u))*(1/3),g=a.sqrt(-u),_=1.7320508075688772*g*a.sin(v),b=s*(-1/3);return g*=a.cos(v),[b-g-_,b-g+_,b+2*g]}if(-i>t||t>i){var y=n*n-4*t*r;return y>=0?(y=a.sqrt(y),[(-n-y)/(2*t),(y-n)/(2*t)]):[]}return-i>n||n>i?[-r/n]:[]}},_halfPI:{enumerable:!1,value:.5*Math.PI},reflectionMatrix:{enumerable:!1,value:function(e,t,n){var r=Math,i=this._halfPI-r.atan2(t,e),a=r.sin(i),o=r.cos(i),s=this._halfPI-r.atan2(n,e*a+t*o),l=r.sin(s);return[l*a,o*l,r.cos(s)]}},reflectedY:{enumerable:!1,value:function(e,t,n,r){return e*r[0]+t*r[1]+n*r[2]}},getScaledKnots:{value:function(e){var t,n=[];for(t=0;this._knots.length>t;t++)this._knots[t]&&(n[t]=[e.x.numerator*this._knots[t][0]/e.x.denominator,e.y.numerator*this._knots[t][1]/e.y.denominator,e.z.numerator*this._knots[t][2]/e.z.denominator]);return n}},getScaledPreviousHandlers:{value:function(e){var t,n=[];for(t=0;this._previousHandlers.length>t;t++)this._previousHandlers[t]&&(n[t]=[e.x.numerator*this._previousHandlers[t][0]/e.x.denominator,e.y.numerator*this._previousHandlers[t][1]/e.y.denominator,e.z.numerator*this._previousHandlers[t][2]/e.z.denominator]);return n}},getScaledNextHandlers:{value:function(e){var t,n=[];for(t=0;this._nextHandlers.length>t;t++)this._nextHandlers[t]&&(n[t]=[e.x.numerator*this._nextHandlers[t][0]/e.x.denominator,e.y.numerator*this._nextHandlers[t][1]/e.y.denominator,e.z.numerator*this._nextHandlers[t][2]/e.z.denominator]);return n}},directedPlaneBezierIntersection:{enumerable:!1,value:function(e,t,n,r,i,a,o,s){for(var l,u,c=this.reflectionMatrix(r[0],r[1],r[2]),h=this.reflectedY(i[0]-e,i[1]-t,i[2]-n,c),d=this.reflectedY(a[0]-e,a[1]-t,a[2]-n,c),p=this.reflectedY(o[0]-e,o[1]-t,o[2]-n,c),f=this.reflectedY(s[0]-e,s[1]-t,s[2]-n,c),m=3*(d-p)+f-h,v=3*(h+p)-6*d,g=3*(d-h),_=this.cubicRealRoots(m,v,g,h),b=0,y=0,w=[];_.length>y&&0>=_[y];)y++;for(;_.length>y&&1>_[y];)l=b,b=_[y],u=.5*(l+b),this.cubic(m,v,g,h,u)>=0&&w.push([l,b]),y++;return u=.5*(b+1),this.cubic(m,v,g,h,u)>=0&&w.push([b,1]),w}}})}}),montageDefine("40094f0","core/products",{dependencies:[],factory:function(e,t){var n=t.Products=function(){};n.prototype.all=[{brand:"Chloe",description:"Hayley Small Hobo Bag",price:1890,color:"Black",image:"images/1.png",background:"#6d6548"},{brand:"Longchamp",description:"Longchamp 3D Leather Hobo Bag",price:720,color:"Cognac",image:"images/2.png",background:"#486d67"},{brand:"Nancy Gonzalez",description:"Small Crocodile Hobo Bag",price:3350,color:"Beige Matte",image:"images/3.png",background:"#242424"},{brand:"Gucci",description:"Original GG Canvas Hobo Bag",price:1240,color:"Medium Camel",image:"images/4.png",background:"#7e1b2b"},{brand:"Nina Ricci",description:"Alphee Medium Leather Hobo Bag",price:2190,color:"Black",image:"images/5.png",background:"#6d645b"},{brand:"Bottega Veneta",description:"Veneta Large Sac Hobo Bag",price:2850,color:"Camel",image:"images/6.png",background:"#5d611a"},{brand:"Prada",description:"Vitello Daino Doubled Flap-Top Hobo Bag",price:2345,color:"Wine (Cerise)",image:"images/7.png",background:"#5d2235"},{brand:"Fendi",description:"Zucca-Print Canvas Small Hobo Bag",price:900,color:"Tobacco",image:"images/8.png",background:"#6d6749"},{brand:"Fendi",description:"Pequin-Striped Large Canvas Hobo Bag",price:1200,color:"Tobacco Brown",image:"images/9.png",background:"#515b66"},{brand:"Valentino",description:"Band Rockstud Round Messenger Bag",price:2375,color:"Black",image:"images/10.png",background:"#76754c"},{brand:"Bottega Veneta",description:"XL Cervo Shoulder Bag",price:2200,color:"Espresso Dark Brown",image:"images/11.png",background:"#8cad3d"},{brand:"Tom Ford",description:"Jennifer Side-Zip Leather Hobo Bag",price:2790,color:"Black",image:"images/12.png",background:"#5e5f8a"},{brand:"Nancy Gonzalez",description:"Crocodile Medium Double-Strap Hobo Bag",price:3750,color:"Kango Matte",image:"images/13.png",background:"#816f68"},{brand:"Tom Ford",description:"Alix Leather Padlock & Zip Fold-Over Bag",price:1990,color:"Cobalt",image:"images/14.png",background:"#3b5385"},{brand:"Marni",description:"Two-Tone Fringe Hobo Bag",price:2590,color:"White/Black",image:"images/15.png",background:"#bc245b"},{brand:"Nancy Gonzalez",description:"Small Crocodile Hobo Bag",price:3350,color:"Pink Matte",image:"images/16.png",background:"#a22d5a"},{brand:"Rag & Bone",description:"Bradbury Mini Flap Crossbody",price:595,color:"Black/White",image:"images/17.png",background:"#71577a"},{brand:"Valentino",description:"Rockstud Metallic Messenger Bag",price:2695,color:"Bronze",image:"images/18.png",background:"#e24f10"},{brand:"Kate Spade New York",description:"Chatham Lane Harris Shoulder Bag",price:378,color:"Stone Gray",image:"images/19.png",background:"#588c5c"},{brand:"Henry Beguelin",description:"Canotta Woven Cervo Hobo Bag",price:1500,color:"Navy/Bicolor",image:"images/20.png",background:"#0f97e9"}],n.prototype.highlighted=[{brand:"Rag & Bone",description:"Bradbury Mini Flap Crossbody",price:595,color:"Black/White",image:"images/17.png",background:"#71577a"},{brand:"Valentino",description:"Rockstud Metallic Messenger Bag",price:2695,color:"Bronze",image:"images/18.png",background:"#e24f10"},{brand:"Kate Spade New York",description:"Chatham Lane Harris Shoulder Bag",price:378,color:"Stone Gray",image:"images/19.png",background:"#588c5c"},{brand:"Henry Beguelin",description:"Canotta Woven Cervo Hobo Bag",price:1500,color:"Navy/Bicolor",image:"images/20.png",background:"#0f97e9"}],n.prototype.topSellers=[{brand:"Gucci",description:"Original GG Canvas Hobo Bag",price:1240,color:"Medium Camel",image:"images/4.png",background:"#7e1b2b"},{brand:"Bottega Veneta",description:"Veneta Large Sac Hobo Bag",price:2850,color:"Camel",image:"images/6.png",background:"#5d611a"},{brand:"Fendi",description:"Zucca-Print Canvas Small Hobo Bag",price:900,color:"Tobacco",image:"images/8.png",background:"#6d6749"},{brand:"Valentino",description:"Band Rockstud Round Messenger Bag",price:2375,color:"Black",image:"images/10.png",background:"#76754c"},{brand:"Tom Ford",description:"Jennifer Side-Zip Leather Hobo Bag",price:2790,color:"Black",image:"images/12.png",background:"#5e5f8a"},{brand:"Marni",description:"Two-Tone Fringe Hobo Bag",price:2590,color:"White/Black",image:"images/15.png",background:"#bc245b"},{brand:"Rag & Bone",description:"Bradbury Mini Flap Crossbody",price:595,color:"Black/White",image:"images/17.png",background:"#71577a"},{brand:"Kate Spade New York",description:"Chatham Lane Harris Shoulder Bag",price:378,color:"Stone Gray",image:"images/19.png",background:"#588c5c"}]}}),montageDefine("aff95ef","ui/flow.reel/flow.html",{text:'<!DOCTYPE html><html><head>\n    <meta charset=utf-8>\n    <link rel=stylesheet href=flow.css>\n    <script type=text/montage-serialization>{"repetition":{"prototype":"ui/repetition.reel","properties":{"element":{"#":"montage-flow-repetition"}},"bindings":{"isSelectionEnabled":{"<-":"@owner.isSelectionEnabled"},"visibleIndexes":{"<-":"@owner._visibleIndexes"},"contentController":{"<-":"@owner.contentController"}}},"flowTranslateComposer":{"prototype":"ui/flow.reel/flow-translate-composer","properties":{"flow":{"@":"owner"},"invertAxis":true,"allowFloats":true,"minScroll":0},"bindings":{"maxScroll":{"<-":"@owner.length"},"_momentumDuration":{"<-":"@owner.momentumDuration"},"translateStride":{"<-":"@owner.stride"},"scrollingMode":{"<-":"@owner.scrollingMode"},"linearScrollingVector":{"<-":"@owner.linearScrollingVector"},"isLimitedToSingleStride":{"<-":"@owner.isLimitedToSingleStride"},"delegate":{"<-":"@owner"}}},"slot":{"prototype":"ui/slot.reel","properties":{"element":{"#":"montage-flow-slot"}},"bindings":{"content":{"<->":"@owner.slotContent"}}},"owner":{"properties":{"element":{"#":"montage-flow"},"_repetition":{"@":"repetition"},"_flowTranslateComposer":{"@":"flowTranslateComposer"},"_cameraElement":{"#":"montage-flow-camera"}},"bindings":{"scroll":{"<->":"@flowTranslateComposer.scroll"},"selection":{"<->":"@repetition.contentController.selection"},"selectedIndexes":{"<-":"@repetition.selectedIndexes"},"activeIndexes":{"<-":"@repetition.activeIndexes"},"draggedSlideIndex":{"<-":"@flowTranslateComposer._closerIndex"},"_firstIteration":{"<-":"@repetition._drawnIterations.0"}}},":iteration":{"alias":"@repetition:iteration"}}</script>\n</head>\n<body>\n    <div data-montage-id=montage-flow class=montage-Flow>\n        <div data-montage-id=montage-flow-camera class=montage-Flow-camera>\n            <div data-montage-id=montage-flow-repetition class=montage-Flow-Repetition>\n                <div data-montage-id=wrapper>\n                    <div data-param=*></div>\n                </div>\n            </div>\n            <div data-montage-id=montage-flow-slot class=montage-Flow-Slot></div>\n        </div>\n    </div>\n\n\n</body></html>'}),montageDefine("40094f0","ui/products-carousel.reel/products-carousel.html",{text:'<!DOCTYPE html><html><head>\n    <title></title>\n    <link rel=stylesheet type=text/css href=products-carousel.css>\n    <script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"owner"}}},"flow":{"prototype":"montage/ui/flow.reel","properties":{"element":{"#":"flow"},"isCameraEnabled":false,"elasticScrollingSpeed":0.6,"stride":1,"sceneScaleX":{"numerator":"1","denominator":"300"},"sceneScaleY":{"numerator":"1","denominator":"1"},"sceneOffsetTop":0,"sceneOffsetLeft":0,"linearScrollingVector":[-300,0],"paths":[{"knots":[{"knotPosition":[-300,0,-200],"nextHandlerPosition":[-200,0,0],"previousDensity":1,"nextDensity":1,"opacity":-0.2,"rotateY":0},{"previousHandlerPosition":[-100,0,0],"knotPosition":[0,0,0],"nextHandlerPosition":[100,0,0],"previousDensity":1,"nextDensity":1,"opacity":2.5,"rotateY":0},{"previousHandlerPosition":[200,0,0],"knotPosition":[300,0,-200],"previousDensity":1,"nextDensity":1,"opacity":-0.2,"rotateY":0}],"headOffset":1,"tailOffset":1,"units":{"opacity":"","rotateY":"rad"}}]},"bindings":{"sceneScaleX.numerator":{"<-":"viewportWidth"},"content":{"<-":"@owner.content"}}},"productsCarouselItem":{"prototype":"ui/products-carousel-item.reel","properties":{"element":{"#":"productsCarouselItem"}},"bindings":{"product":{"<-":"@flow:iteration.object"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=owner class=ProductsCarousel>\n        <div data-montage-id=flow class=ProductsCarousel-flow>\n            <div data-montage-id=productsCarouselItem></div>\n        </div>\n    </div>\n\n\n</body></html>'}),montageDefine("40094f0","ui/products-carousel2.reel/products-carousel2.html",{text:'<!DOCTYPE html><html><head>\n    <title></title>\n    <link rel=stylesheet type=text/css href=products-carousel2.css>\n    <script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"owner"}}},"flow":{"prototype":"montage/ui/flow.reel","properties":{"element":{"#":"flow"},"isCameraEnabled":false,"elasticScrollingSpeed":0.6,"stride":1,"sceneScaleX":{"numerator":"1","denominator":"300"},"sceneScaleY":{"numerator":"1","denominator":"1"},"sceneOffsetTop":0,"sceneOffsetLeft":25,"linearScrollingVector":[-150,0],"paths":[{"knots":[{"knotPosition":[-300,0,0],"nextHandlerPosition":[-200,0,0],"previousDensity":2,"nextDensity":2,"rotateY":0},{"previousHandlerPosition":[-100,0,0],"knotPosition":[0,0,0],"nextHandlerPosition":[100,0,0],"previousDensity":2,"nextDensity":2,"rotateY":0},{"previousHandlerPosition":[200,0,0],"knotPosition":[300,0,0],"previousDensity":2,"nextDensity":2,"rotateY":0}],"headOffset":1.5,"tailOffset":2.5,"units":{"rotateY":"rad"}}]},"bindings":{"sceneScaleX.numerator":{"<-":"viewportWidth"},"content":{"<-":"@owner.content"}}},"productsCarousel2Item":{"prototype":"ui/products-carousel2-item.reel","properties":{"element":{"#":"productsCarousel2Item"}},"bindings":{"product":{"<-":"@flow:iteration.object"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=owner class=ProductsCarousel2>\n        <div data-montage-id=flow class=ProductsCarousel2-flow>\n            <div data-montage-id=productsCarousel2Item></div>\n        </div>\n    </div>\n\n\n</body></html>'}),montageDefine("40094f0","ui/products-carousel-item.reel/products-carousel-item.html",{text:'<!DOCTYPE html><html><head>\n    <title></title>\n    <link rel=stylesheet type=text/css href=products-carousel-item.css>\n    <script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"owner"},"blurredImageElement":{"#":"blurredImage"},"imageElement":{"#":"image"}},"bindings":{"background":{"<-":"@owner.product.background"},"image":{"<-":"@owner.product.image"}}},"brand":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"brand"}},"bindings":{"value":{"<-":"@owner.product.brand"}}},"description":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"description"}},"bindings":{"value":{"<-":"@owner.product.description"}}},"color":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"color"}},"bindings":{"value":{"<-":"@owner.product.color"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=owner class=ProductsCarouselItem>\n        <div data-montage-id=blurredImage class=ProductsCarouselItem-blurredImage></div>\n        <div data-montage-id=brand class=ProductsCarouselItem-brand></div>\n        <div class=ProductsCarouselItem-info>\n            <div data-montage-id=color class=ProductsCarouselItem-color></div>\n            <div data-montage-id=description class=ProductsCarouselItem-description></div>\n        </div>\n        <div data-montage-id=image class=ProductsCarouselItem-image></div>\n    </div>\n\n\n</body></html>'}),montageDefine("40094f0","ui/main.reel/main.html",{text:'<!DOCTYPE html><html><head>\n    <meta http-equiv=content-type content="text/html; charset=utf-8">\n    <title>Main</title>\n    <script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"main"}}},"layout":{"prototype":"ui/layout.reel","properties":{"element":{"#":"layout"}}},"products":{"prototype":"core/products"},"header":{"prototype":"ui/header.reel","properties":{"element":{"#":"header"}}},"carousel":{"prototype":"ui/products-carousel.reel","properties":{"element":{"#":"carousel"}},"bindings":{"content":{"<-":"@products.highlighted"}}},"carousel2":{"prototype":"ui/products-carousel2.reel","properties":{"element":{"#":"carousel2"}},"bindings":{"content":{"<-":"@products.topSellers"}}},"grid":{"prototype":"ui/products-grid.reel","properties":{"element":{"#":"grid"}},"bindings":{"content":{"<-":"@products.all"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=main class=Main>\n        <div data-montage-id=layout>\n            <div data-arg=header data-montage-id=header></div>\n            <div data-arg=block1 data-montage-id=carousel></div>\n            <div data-arg=block2 data-montage-id=carousel2></div>\n            <div data-arg=block3 data-montage-id=grid></div>\n        </div>\n    </div>\n\n\n</body></html>'}),montageDefine("40094f0","ui/products-carousel2-item.reel/products-carousel2-item.html",{text:'<!DOCTYPE html><html><head>\n    <title></title>\n    <link rel=stylesheet type=text/css href=products-carousel2-item.css>\n    <script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"owner"},"imageElement":{"#":"image"}},"bindings":{"background":{"<-":"@owner.product.background"},"image":{"<-":"@owner.product.image"}}},"brand":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"brand"}},"bindings":{"value":{"<-":"@owner.product.brand"}}},"description":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"description"}},"bindings":{"value":{"<-":"@owner.product.description"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=owner class=ProductsCarousel2Item>\n        <div class=ProductsCarousel2Item-info>\n            <div data-montage-id=brand class=ProductsCarousel2Item-brand></div>\n            <div data-montage-id=description class=ProductsCarousel2Item-description></div>\n        </div>\n        <div data-montage-id=image class=ProductsCarousel2Item-image></div>\n    </div>\n\n\n</body></html>'}),montageDefine("aff95ef","ui/slot.reel/slot",{dependencies:["../component"],factory:function(e,t){var n=e("../component").Component;t.Slot=n.specialize({hasTemplate:{enumerable:!1,value:!1},constructor:{value:function(){this.super(),this.content=null}},delegate:{value:null},_content:{value:null},enterDocument:{value:function(e){e&&this.element.classList.add("montage-Slot")}},content:{get:function(){return this._content},set:function(e){var t,r;e&&void 0!==e.needsDraw?(r=this._content,r&&void 0!==r.needsDraw&&r.detachFromParentComponent(),e.element?t=e.element:(t=document.createElement("div"),t.id="appendDiv",this.delegate&&"function"==typeof this.delegate.slotElementForComponent&&(t=this.delegate.slotElementForComponent(this,e,t)),e.element=t),Object.getPropertyDescriptor(n,"domContent").set.call(this,t),this.addChildComponent(e),e.needsDraw=!0):Object.getPropertyDescriptor(n,"domContent").set.call(this,e),this._content=e,this.needsDraw=!0}},contentDidChange:{value:function(e,t){this.delegate&&"function"==typeof this.delegate.slotDidSwitchContent&&this.delegate.slotDidSwitchContent(this,e,e?e.component:null,t,t?t.component:null)}}})}}),montageDefine("40094f0","ui/products-grid-item.reel/products-grid-item.html",{text:'<!DOCTYPE html><html><head>\n    <title></title>\n    <link rel=stylesheet type=text/css href=products-grid-item.css>\n    <script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"owner"},"imageElement":{"#":"image"}},"bindings":{"background":{"<-":"@owner.product.background"},"image":{"<-":"@owner.product.image"}}},"brand":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"brand"}},"bindings":{"value":{"<-":"@owner.product.brand"}}},"description":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"description"}},"bindings":{"value":{"<-":"@owner.product.description"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=owner class=ProductsGridItem>\n        <div class=ProductsGridItem-info>\n            <div data-montage-id=image class=ProductsGridItem-image></div>\n            <div data-montage-id=brand class=ProductsGridItem-brand></div>\n            <div data-montage-id=description class=ProductsGridItem-description></div>\n        </div>\n    </div>\n\n\n</body></html>'}),montageDefine("aff95ef","composer/composer",{dependencies:["../core/target"],factory:function(e,t){var n=e("../core/target").Target;t.Composer=n.specialize({_component:{value:null},component:{get:function(){return this._component},set:function(e){this._component=e}},_element:{value:null},element:{get:function(){return this._element},set:function(e){this._element=e}},lazyLoad:{value:!0},_needsFrame:{value:!1},needsFrame:{set:function(e){this._needsFrame!==e&&(this._needsFrame=e,this._component&&e&&this._component.scheduleComposer(this))},get:function(){return this._needsFrame}},frame:{value:Function.noop},_resolveDefaults:{value:function(){this.element||null!=this.element||null==this.component||(this.element=this.component.element)}},_isLoaded:{value:!1},isLoaded:{get:function(){return this._isLoaded}},load:{value:Function.noop},unload:{value:Function.noop},deserializedFromTemplate:{value:function(){this.component&&this.component.addComposer(this)}}},{isCoordinateOutsideRadius:{value:function(e,t,n){return e*e+t*t>n*n}}})}}),montageDefine("40094f0","ui/products-grid.reel/products-grid.html",{text:'<!DOCTYPE html><html><head>\n    <title></title>\n    <link rel=stylesheet type=text/css href=products-grid.css>\n    <script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"owner"}}},"repetition":{"prototype":"montage/ui/repetition.reel","properties":{"element":{"#":"repetition"}},"bindings":{"content":{"<-":"@owner.content"}}},"productsGridItem":{"prototype":"ui/products-grid-item.reel","properties":{"element":{"#":"productsGridItem"}},"bindings":{"product":{"<-":"@repetition:iteration.object"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=owner class=ProductsGrid>\n        <div data-montage-id=repetition class=ProductsGrid-repetition>\n            <div data-montage-id=productsGridItem></div>\n        </div>\n    </div>\n\n\n</body></html>'}),montageDefine("aff95ef","ui/text.reel/text",{dependencies:["../component"],factory:function(e,t){var n=e("../component").Component;t.Text=n.specialize({constructor:{value:function(){this.super()}},hasTemplate:{value:!1},_value:{value:null},value:{get:function(){return this._value},set:function(e){this._value!==e&&(this._value=e,this.needsDraw=!0)}},converter:{value:null},defaultValue:{value:""},_valueNode:{value:null},_RANGE:{value:document.createRange()},enterDocument:{value:function(e){if(e){var t=this._RANGE;t.selectNodeContents(this.element),t.deleteContents(),this._valueNode=document.createTextNode(""),t.insertNode(this._valueNode),this.element.classList.add("montage-Text")}}},draw:{value:function(){var e=this._value,t=e||0===e?e:this.defaultValue;this.converter&&(t=this.converter.convert(t)),this._valueNode.data=t}}})}}),montageDefine("40094f0","ui/layout.reel/layout.html",{text:'<!DOCTYPE html><html><head>\n    <title></title>\n    <link rel=stylesheet type=text/css href=layout.css>\n    <script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"owner"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=owner class=Layout>\n        <div class=Layout-header>\n            <div data-param=header></div>\n        </div>\n        <div class=Layout-body>\n            <div class=Layout-block1>\n                <div data-param=block1></div>\n            </div>\n            <div class=Layout-block2>\n                <div data-param=block2></div>\n            </div>\n            <div class=Layout-block3>\n                <div data-param=block3></div>\n            </div>\n        </div>\n    </div>\n\n\n</body></html>'}),montageDefine("40094f0","ui/products-carousel-item.reel/products-carousel-item",{dependencies:["montage/ui/component"],factory:function(e,t){var n=e("montage/ui/component").Component;t.ProductsCarouselItem=n.specialize({_image:{value:null},image:{get:function(){return this._image},set:function(e){this._image!==e&&(this._image=e,e&&(this.needsDraw=!0))}},_background:{value:null},background:{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,e&&(this.needsDraw=!0))}},draw:{value:function(){this._image&&(this.imageElement.style.backgroundImage="url(assets/"+this._image+")",this.blurredImageElement.style.backgroundImage="url(assets/"+this._image+")"),this._background&&(this._element.style.backgroundColor=this._background)}}})}}),montageDefine("40094f0","ui/products-carousel2-item.reel/products-carousel2-item",{dependencies:["montage/ui/component"],factory:function(e,t){var n=e("montage/ui/component").Component;t.ProductsCarousel2Item=n.specialize({_image:{value:null},image:{get:function(){return this._image},set:function(e){this._image!==e&&(this._image=e,e&&(this.needsDraw=!0))}},_background:{value:null},background:{get:function(){return this._background},set:function(e){this._background!==e&&(this._background=e,e&&(this.needsDraw=!0))}},draw:{value:function(){this._image&&(this.imageElement.style.backgroundImage="url(assets/"+this._image+")"),this._background&&(this._element.style.backgroundColor=this._background)}}})}}),montageDefine("aff95ef","core/browser",{dependencies:["montage"],factory:function(e,t){var n=e("montage").Montage,r=RegExp(/AppleWebKit\/([\d.]+)/),i=n.specialize({constructor:{value:function i(e){this.super(),this._userAgent=e,this._analyze(e)}},_analyze:{value:function(e){if(e.indexOf("Android")>-1&&e.indexOf("Mozilla/5.0")>-1&&e.indexOf("AppleWebKit")>-1){this.android={};var t=r.exec(e),n=null===t?null:parseFloat(r.exec(e)[1]);this.android.androidBrowser=null!==n&&537>n}}},_userAgent:{value:null}}),a=null;n.defineProperties(t,{browser:{get:function(){return null===a&&(a=new i(navigator.userAgent)),a}},Browser:{value:i}})}}),montageDefine("40094f0","ui/products-grid-item.reel/products-grid-item",{dependencies:["montage/ui/component"],factory:function(e,t){var n=e("montage/ui/component").Component;t.ProductsGridItem=n.specialize({_image:{value:null},image:{get:function(){return this._image},set:function(e){this._image!==e&&(this._image=e,e&&(this.needsDraw=!0))}},draw:{value:function(){this._image&&(this.imageElement.style.backgroundImage="url(assets/"+this._image+")")}}})}}),montageDefine("40094f0","ui/header.reel/header.html",{text:'<!DOCTYPE html><html><head>\n    <title></title>\n    <link rel=stylesheet type=text/css href=header.css>\n    <script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"owner"}}}}</script>\n</head>\n<body>\n    <div data-montage-id=owner class=Header>\n        <div class=Header-logo>Acme Handbags</div>\n    </div>\n\n\n</body></html>'}),montageDefine("40094f0","ui/products-carousel2.reel/products-carousel2",{dependencies:["montage/ui/component"],factory:function(e,t){var n=e("montage/ui/component").Component;t.ProductsCarousel2=n.specialize({constructor:{value:function(){this.super()}}})}}),montageDefine("40094f0","ui/products-carousel.reel/products-carousel",{dependencies:["montage/ui/component"],factory:function(e,t){var n=e("montage/ui/component").Component;t.ProductsCarousel=n.specialize({constructor:{value:function(){this.super()}}})}}),montageDefine("40094f0","ui/products-grid.reel/products-grid",{dependencies:["montage/ui/component"],factory:function(e,t){var n=e("montage/ui/component").Component;t.ProductsGrid=n.specialize({constructor:{value:function(){this.super()}}})}}),montageDefine("40094f0","ui/header.reel/header",{dependencies:["montage/ui/component"],factory:function(e,t){var n=e("montage/ui/component").Component;t.Header=n.specialize({constructor:{value:function(){this.super()}}})}}),montageDefine("40094f0","ui/main.reel/main",{dependencies:["montage/ui/component"],factory:function(e,t){var n=e("montage/ui/component").Component;t.Main=n.specialize({constructor:{value:function(){this.super()}}})}}),montageDefine("40094f0","ui/layout.reel/layout",{dependencies:["montage/ui/component"],factory:function(e,t){var n=e("montage/ui/component").Component;t.Layout=n.specialize()}});
bundleLoaded("index.html.bundle-1-0.js")